<div class="card m-3">   
    <div class="card-header bg-lightblue card-height55">
        <div class="card-title m-0">
            <h4 class="fw-bolder text-blue">Employeewise Payment</h4>
        </div>
    </div>
    <form [formGroup]="Employeewisepaymentform" #ngform>
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-3 col-md-3 col-sm-12"><span>Branch</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <ng-select class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2" formControlName="Branch" bindLabel="branch_name"
                    bindValue="branch_gid" [items]="branch_list"
                        placeholder="Select an option"></ng-select>
                </div>
            </div>
            <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span>Month</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <ng-select class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2" formControlName="Month"
                        placeholder="Select an option">
                        <ng-option value="January">January</ng-option>
                        <ng-option value="February">February</ng-option>
                        <ng-option value="March">March</ng-option>
                        <ng-option value="April">April</ng-option>
                        <ng-option value="May">May</ng-option>
                        <ng-option value="June">June</ng-option>
                        <ng-option value="July">July</ng-option>
                        <ng-option value="August">August</ng-option>
                        <ng-option value="September">September</ng-option>
                        <ng-option value="October">October</ng-option>
                        <ng-option value="November">November</ng-option>
                        <ng-option value="December">December</ng-option>
                    </ng-select>
                </div>
            </div>
            <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="required">Year</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text"                 
                    [ngStyle]="{ 'border-color': Employeewisepaymentform.get('Year')?.hasError('required') && Employeewisepaymentform.get('Year')?.touched ? 'red' : 'rgb(209, 209, 209)' }"
                        class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
                        placeholder="Year" formControlName="Year" />                       
                </div>
            </div>
            <div class="text-center my-4">
                <button class="btn-primary text-white mt-5"(click)=" GetEmployeewisepaymentSummary()">
                    <i class="fas fa-check text-white fs-5"></i>
                  Search
                </button>
            </div>
            <div class="col-12 col-lg-1 col-md-1 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-9 ms-3">
                  <button title="Export Excel" type="button" class="btn-success btn-sm bg-export"
                    (click)="exportExcel()">
                    <i class="bi bi-file-earmark-arrow-up"></i>
                  </button>
                </div>
              </div>
        </div>
    </form>
   
    <div class="table-responsive ">
        <div class="card card-body m-3 p-3 mb-3 bg-white rounded">
            <table id="employeewisepayment_list" class="table table-striped table-row-bordered gy-5 gs-7">
                <thead>
                    <tr class=" text-blue fw-bold fs-5 text-nowrap bg-lightblue align-middle">
                        <th>S.No</th>
                        <th>Department Name </th>
                        <th>User Code</th>
                        <th>Employee Name</th>
                        <th>Designation Name</th>
                        <th>Month</th>
                        <th>Year</th>
                        <th>Payment Type</th>
                        <th>Total Salary</th>                   

                      
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of employeewisepayment_list; let i=index;" class="align-middle">
                        <td>{{i+1}}</td>
                        <td>{{data.Department_Name}}</td>
                        <td>{{data.User_Code}}</td>
                        <td>{{data.Employee_Name}}</td>
                        <td>{{data.Designation_Name}}</td>
                        <td>{{data.Month}}</td>
                        <td>{{data.Year}}</td>
                        <td>{{data.Payment_Type}}</td>
                        <td>{{data.Total_Salary}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
