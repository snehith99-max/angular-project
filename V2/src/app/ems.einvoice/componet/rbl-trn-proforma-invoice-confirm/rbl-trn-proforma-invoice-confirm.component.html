<div class="card rounded-top">
    <div class="card-title p-5 pb-6 pt-6 rounded-top bg-primary">
        <h3 class="fw-bolder text-white"><i class="fas fa-plus fw-bolder fs-3 me-4"></i>
            Confirm Proforma Invoice
        </h3>
    </div>

    <div class="m-3">
        <form [formGroup]="proformainvoiceconfirmform">
            <div class="d-flex flex-row m-6 flex-wrap">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Invoice Reference
                        No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-white border-secondary custom-input"
                            formControlName="proforma_invoice_refno" readonly placeholder="New Ref.No">
                    </div>
                </div>

                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold required">Invoice
                        Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="hidden" formControlName="proforma_salesorder_gid">
                        <input type="date"
                            class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white custom-input date-picker mt-2"
                            placeholder="DD-MM-YYYY" formControlName="proforma_invoice_date" pattern="^(?!\s*$).+" />
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">SO Reference No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_so_ref_no" readonly>
                    </div>
                </div>
            </div>

            <div class="d-flex flex-row m-6 flex-wrap">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">SO Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_so_date" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Payment Term (In
                        Days)</span>
                    <ng-select class="col-12 col-lg-11 col-md-11 col-sm-11 fv-row mt-2"
                        formControlName="proforma_invoice_payterm" [(ngModel)]="mdlperformainvoice"
                        placeholder="Select an option">
                        <ng-option value="0">0 Days</ng-option>
                        <ng-option value="7">7 Days</ng-option>
                        <ng-option value="15">15 Days</ng-option>
                        <ng-option value="30">30 Days</ng-option>
                        <ng-option value="45">45 Days</ng-option>
                        <ng-option value="60">60 Days</ng-option>
                        <ng-option value="90">90 Days</ng-option>
                        <ng-option value="120">120 Days</ng-option>
                    </ng-select>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Due Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid date-picker mb-3 mb-lg-0 bg-white custom-input"
                            placeholder="DD-MM-YYYY" formControlName="proforma_invoice_due_date"
                            pattern="^(?!\s*$).+" />
                    </div>
                </div>


            </div>
            <div class="d-flex flex-row m-6 flex-wrap mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Invoice Raised By</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary border-secondary custom-input text"
                            formControlName="proforma_invoice_raised_by" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Customer Reference
                        No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_cust_ref_no" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Customer Name</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_customer_name" readonly>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 flex-wrap mt-2 mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Branch</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_branch">
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2 "><span class="font-bold">Contact Person</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_contact_person" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Contact Number</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_contact_no" maxlength="15" readonly>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 flex-wrap mt-2 mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Email Address</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_email_address" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Address</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text"
                            class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary custom-input"
                            placeholder="" formControlName="proforma_address" class="form-control bg-secondary"
                            rows="3"></textarea>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Remarks</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text"
                            class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 border-secondary bg-white custom-input"
                            placeholder="" formControlName="proforma_remarks" rows="5" readonly></textarea>

                    </div>
                </div>
            </div>

            <div class="d-flex flex-row m-6 flex-wrap mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Sales Person</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_sales_person" readonly>
                    </div>
                </div>

                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Expected Start Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_expected_start_date" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Estimated Arrival Time</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_estimated_arrival_time" readonly>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 flex-wrap mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Freight Terms</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_freight_terms" readonly>
                    </div>
                </div>

                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Payment Terms</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_payment_terms" readonly>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Currency</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input text"
                            formControlName="proforma_currency" readonly>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 flex-wrap mt-2">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Exchange Rate</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text"
                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-white border-secondary custom-input"
                            formControlName="proforma_exchange_rate">
                    </div>
                </div>

            </div>


            <div class="table-responsive">
                <div class="card card-body m-0 p-3 mb-5 bg-white rounded mt-7">
                    <table id="product" class="table table-striped table-row-bordered gy-4 gs-2">
                        <thead>
                            <tr class="text-white fw-bold fs-5 text-nowrap bg-lightblue text-blue">
                                <th>S.No</th>
                                <th>Product Group</th>
                                <th>Customer Product Code</th>
                                <th>Product & Description</th>
                                <th>Unit</th>
                                <th style="text-align: right;">Billed Quantity</th>
                                <th style="text-align: center;">Discount</th>
                                <th style="text-align: right;"> Unit Price</th>
                                <th style="text-align: center; width: 120px;">Tax</th>
                                <th style="text-align: centre;">Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of proformainvoicelist1; let i=index;">
                                <td>{{i+1}}</td>
                                <td>{{data.productgroup_name}}</td>
                                <td>{{data.customerproduct_code}}</td>
                                <td>
                                    <div> {{data.product_name}}</div>
                                    <div> {{data.product_description}}</div>
                                </td>
                                <td>{{data.productuom_name}}</td>
                                <td style="text-align: right;">{{data.qty_invoice}}</td>
                                <td style="text-align: right;">
                                    <div> {{data.margin_percentage}}</div>
                                    <div> {{data.margin_amount}}</div>
                                </td>
                                <td style="text-align: center;">{{data.product_price}}</td>
                                <td style="text-align: right;">
                                    <div> {{data.tax_name}}</div>
                                    <div> {{data.tax_amount1}}</div>
                                </td>
                                <td style="text-align: right;">{{data.total_amount}}</td>
                                
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <div class="d-flex flex-row m-4 flex-wrap">
                <div class="col-12 col-lg-8 col-md-4 col-sm-12">
                    <div class="card-header bg-lightblue card-height55">
                        <div class="card-title m-0">
                            <h5 class="fw-bolder text-blue">Terms and Conditions</h5>
                        </div>
                    </div>
                    <ng-select class="custom col-lg-6 m-6 col-12 fv-row mt-5" bindLabel="template_name"
                        [(ngModel)]="mdlTerms" formControlName="template_name" bindValue="template_gid"
                        placeholder="Select an option"></ng-select>
                    <div class="d-flex flex-row m-2 col-lg-12 table-responsive">
                        <div class="col-12 col-lg-12 col-md-12  col-sm-12 fv-row mt-2">
                            <angular-editor [config]="config" formControlName="termsandconditions"></angular-editor>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab ">Net Amount :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold bg-secondary"
                                    formControlName="proforma_net_amount" style="width:120px; text-align: right;"
                                    readonly>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Overall Tax :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">

                                <input type="text" class="form-control fw-bold bg-secondary"
                                    formControlName="proforma_overall_tax" style="width:120px; text-align: right;"
                                    readonly>
                            </div>
                        </div>
                    </div>


                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Total Amount with Tax :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold bg-secondary"
                                    [(ngModel)]="Totalamountwithtax" (ngModelChange)="finaltotal()"
                                    formControlName="proforma_total_amount_tax" style="width:120px; text-align: right;"
                                    readonly>

                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Maximum Addon Amount :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold bg-secondary"
                                    formControlName="proforma_maximum_addon_amount"
                                    style="width:120px; text-align: right;" readonly>

                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Maximum Addon Discount :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold bg-secondary"
                                    formControlName="proforma_maximum_addon_discount_amount"
                                    style="width:120px; text-align: right;" readonly>

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Freight Charges :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold " [(ngModel)]="freightcharges"
                                    (ngModelChange)="finaltotal()" formControlName="proforma_freight_charges"
                                    style="width:120px; text-align: right;">

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Buyback Charges :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold " [(ngModel)]="buybackscrap"
                                    formControlName="proforma_buy_back_scrap_charges" (ngModelChange)="finaltotal()"
                                    style="width:120px; text-align: right;">

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Packing Charges :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold " [(ngModel)]="forwardingcharges"
                                    formControlName="proforma_packing_forwarding_charges" (ngModelChange)="finaltotal()"
                                    style="width:120px; text-align: right;">

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Insurance Charges :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold " [(ngModel)]="insurancecharges"
                                    formControlName="proforma_insurance_charges" (ngModelChange)="finaltotal()"
                                    style="width:120px; text-align: right;">

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab"> Round Off :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">

                                <input type="text" class="form-control fw-bold " formControlName="proforma_roundoff"
                                    [(ngModel)]="roundoff" (ngModelChange)="finaltotal()"
                                    style="width:120px; text-align: right;">

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Grand Total :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold bg-secondary" [(ngModel)]="Grandtotal"
                                    formControlName="proforma_grandtotal" style="width:120px; text-align: right;"
                                    (ngModelChange)="finaltotal()" readonly>

                            </div>
                        </div>
                    </div>

                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Advance Amount :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="row">
                                <div class="col-lg-3 col-12 col-md-11 col-sm-11 fv-row">
                                    <input type="text" class="form-control fw-bold " (ngModelChange)="totalvalue()"
                                        formControlName="proforma_advance_percentage"
                                        [(ngModel)]="proformaadvancepercentage" style="width:70px; text-align: right;">
                                </div>
                                <div class="col-lg-1 col-12 col-md-11 col-sm-11 fv-row mt-2 ms-9">
                                    <span class="fw-bold ms-3 text-black">%</span>
                                </div>
                                <div class="col-lg-3 col-12 col-md-11 col-sm-11 fv-row ms-3">
                                    <input type="text" class="form-control fw-bold " (ngModelChange)="totalvalue()"
                                        formControlName="proforma_advance_amount" [(ngModel)]="proformaadvanceamount"
                                        style="width:70px; text-align: right;">
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="d-flex flex-row m-6 flex-wrap">
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <label class="tbl_lab">Advance Roundoff :</label>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                                <input type="text" class="form-control fw-bold " (ngModelChange)="overalltotal()"
                                    [(ngModel)]="proformaadvanceroundoff" formControlName="proforma_advance_roundoff"
                                    style="width:120px; text-align: right;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card" m-3>
                <div class="text-center my-4">
                    <button type="submit" class="btn-success btn-sm text-white me-4" (click)="proformainvoicesubmit()">
                        <i class="bi bi-check-square fs-7 me-1"></i>
                        Submit
                    </button>

                    <button class="btn-primary btn-sm text-white me-4" (click)="back()">
                        <i class="bi bi-arrow-left-square fs-7 me-1"></i>
                        Back
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>