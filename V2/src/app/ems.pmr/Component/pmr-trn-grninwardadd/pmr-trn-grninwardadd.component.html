<div class="card mt-8">
  <div class="card-title p-5 pb-3 pt-3 rounded-top bg-primary d-flex justify-content-between align-items-center">
    <h1 class="fw-bolder text-white"><i class="fa-solid fa-receipt fs-2" aria-hidden="true"></i>&nbsp;&nbsp;GRN</h1>


    <button style="color: black !important;" class="btn btn-icon btn-sm bg-secondary cursor-pointer " title="back"
      routerLink="/pmr/PmrTrnGrninwardadd"><i class="fa-solid fa-arrow-left-long fs-1 fw-bold"></i></button>


  </div>



  <div class="card mt-1 m-3 mb-0">
    <div class="card-header d-flex align-items-center mb-3 cursor-pointer no-arrow" style="background-color: #def0ff;">
      <div>
        <p class="card-title fw-bold fs-3 no-arrow" style="color: #2599ff;">
          <i class="fa-solid fa-clipboard fs-1"></i> &nbsp;&nbsp;GRN Details
        </p>
      </div>

    </div>


    <form [formGroup]="addgrnform">
      <div class="d-flex flex-row m-2 flex-wrap">
        <!-- -------------- Entity ------------- -->
        <div class="col-12 col-lg-4 col-md-4 col-sm-12">
          <span class="font-bold">Branch </span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="branch_name"
              class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
              placeholder="Branch Name" style="height:40px;" readonly />
          </div>
        </div>
        <!-- --------------Delivery No  ------------- -->
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold" [ngClass]="{'error_input_field': dc_no.invalid && dc_no.touched }">Delivery No<span
              class="ms-1 text-red">*</span></span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="dc_no" required [ngClass]="{'invalid-border': dc_no.invalid && dc_no.touched}"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input "
              placeholder="Delivery No" style="height:40px;" pattern="^(?!\s*$).+" />
          </div>
        </div>
        <!-- -------------- Date ------------- -->
        <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold">Date<span class="ms-1 text-red">*</span></span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': addgrnform.get('grn_date')?.hasError('required')
                     && addgrnform.get('grn_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}" formControlName="grn_date"
              class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
               custom-input date-picker " placeholder="DD-MM-YYYY" style="height: 40px;" />
          </div>
        </div> -->

        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <div class="d-flex flex-row  flex-wrap">
            <div class="col-12 col-lg-6 col-md-6 col-sm-12">
              <span class="font-bold">Date<span class="ms-1 text-red">*</span></span>
              <div class="col-lg-1o col-12 col-md-10 col-sm-10 fv-row mt-2">
                <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': addgrnform.get('grn_date')?.hasError('required')
                   && addgrnform.get('grn_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}" formControlName="grn_date" class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
                   custom-input date-picker " placeholder="DD-MM-YYYY" style="height: 40px;" />
              </div>
            </div>
            <div class="col-12 col-lg-6 col-md-6 col-sm-12">
              <span class="font-bold">Expected Date <span class="ms-1 text-red">*</span></span>
              <div class="col-lg-10 col-12 col-md-10 col-sm-10 fv-row mt-2">
                <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': addgrnform.get('expected_date')?.hasError('required')
                  && addgrnform.get('expected_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
                  formControlName="expected_date" class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
                  custom-input date-picker " placeholder="DD-MM-YYYY" style="height: 40px;"/>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="d-flex flex-row m-2 flex-wrap">
        <div class="col-12 col-lg-4 col-md-3 col-sm-12">
          <!-- -------------- Vendor------------- -->
          <span class="font-bold">Vendor</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="vendor_companyname"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input "
              placeholder="Vendor" style="height:40px;" readonly />
          </div>
          <div class="col-11  fv-row mt-2 ">
            <textarea type="text"
              class=" mt-4 form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
              placeholder="Vendor Details" formControlName="vendor_details" readonly class="form-control"
              rows="5"></textarea>
          </div>
        </div>


        <!-- -------------- Shipment To ------------- -->
        <div class="col-12 col-lg-4 col-md-3 col-sm-12">
          <span class="font-bold">Ship To</span>
          <div class="col-11 fv-row mt-2">
            <textarea type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
              placeholder="Shipment To" formControlName="address" class="form-control" rows="7" readonly></textarea>
          </div>
        </div>

        <div class="col-12 col-lg-4 col-md-3 col-sm-12">
          <!-- -------------- Mode Of Despatch------------- -->
          <span class="font-bold">Mode Of Despatch </span>
          <!-- <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="modeof_dispatch"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input "
              placeholder="Mode Of Despatch" style="height:40px;" pattern="^(?!\s*$).+" />
          </div> -->
          <div class="col-11  fv-row mt-2">           
            <ng-select style="height:25px;"  [items]="modeofdispatch_list"
             class="custom col-lg-12 col-12 fv-row no-arrow"
              bindLabel="name"
             formControlName="modeof_dispatch" bindValue="id" placeholder="Select Mode of Dispatch"> </ng-select>
            </div>
          <div class="col-11  fv-row mt-2">
            <input type="text" formControlName="deliverytracking"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input "
              placeholder="Delivery Tracking No" style="height:40px;" pattern="^(?!\s*$).+" />
          </div>
          <div class="col-11  fv-row mt-2">
            <input type="number" formControlName="no_box"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input " pattern="^(?!\s*$).+"
              placeholder="No of Boxes" />
          </div>
          <div class="col-11  fv-row mt-2" *ngIf="mintsoft_flag === 'Y'">           
            <ng-select style="height:25px;"  [items]="GetASN_list"
             class="custom col-lg-12 col-12 fv-row no-arrow"
              bindLabel="goodsintypes_name"
             formControlName="goodsintypes_id" bindValue="goodsintypes_id" placeholder="Select GoodsInType"> </ng-select>
          </div>
        </div>
      </div>
      <!-- -------------- Delivery Note   ------------- -->
      <!-- <div class="d-flex flex-row m-2 flex-wrap">
        <div class="col-12 col-lg-12 col-md-4 col-sm-12"><span class="font-bold">Receive Note</span>
          <div class="col-lg-12 col-12 col-md-4 col-sm-11 fv-row mt-2">
            <textarea style="width: 97%;" type="text" class="
              form-control form-control-lg form-control-solid custom-input
              mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="received_note"
              placeholder="Receive Note" class="form-control " rows="3"></textarea>
          </div>
        </div>
      </div> -->

      <div class="d-flex flex-row m-2 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold">Upload File</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input (change)="onChange2($event)" accept="image/*" type="file" #fileInput
              class="form-control form-control-lg form-control-solid bg-white mb-3 mb-lg-0  borderc-secondary custom-input"
              name="fName" />
          </div>
        </div>
        <div class="col-12 col-lg-8 col-md-4 col-sm-11"><span class="font-bold">Receive Note</span>
          <div class="col-lg-12 col-12 col-md-4 col-sm-11 fv-row mt-2">
            <textarea style="width: 96%;" type="text" class="
              form-control form-control-lg form-control-solid custom-input
              mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="received_note"
              placeholder="Receive Note" class="form-control " rows="3"></textarea>
          </div>
        </div>


      </div>

      <div class="table-responsive">
        <div class="card card-body m-0 p-3 mb-5 bg-white rounded table-responsive">
          <table id="addgrn_lists" class="table table-striped table-bordered text-blue border-bottom gs-7 align-middle">
            <thead class="table_head">
              <tr class="fw-bold fs-6 text-nowrap bg-lightblue text-blue align-middle">
                <th class="text-blue text-center" style="width: 10%;">Product Group</th>
                <th class="text-blue text-center" style="width: 20%;">Product</th>
                <th class="text-blue text-center" style="width: 25%;">Description</th>
                <th class="text-blue text-center" style="width: 7%;">Ordered Qty</th>
                <th class="text-blue text-center" style="width: 7%;">Delivered Qty</th>
                <th class="text-blue text-center" style="width: 7%;">Received Qty</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of addgrn_lists; let i=index;" class="align-middle">
                <td>{{data.productgroup_name}}</td>
                <td>{{data.product_code}}/{{data.product_name}}</td>
                <td>{{data.display_field_name}}</td>
                <td>{{data.qty_ordered}} {{data.productuom_name}}</td>
                <td>{{data.qty_delivered}} {{data.productuom_name}}</td>
                <td>

                    <ng-container  *ngIf="data.producttype_name !== 'Services';else Service">                   
                      <input type="text" (ngModelChange)="qytrecived(i, data.qty_ordered, $event)"
                      class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
                      formControlName="qty_received_{{i}}" [(ngModel)]="data.qty_received" style="text-align: right;" />
                    </ng-container>
                    <ng-template #Service >
                      <div style="width: 100%; text-align: center;">
                      <span style="color: red;"> Service Product</span>
                      </div>
                  </ng-template>
 
                </td>
                
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!--  -->

      <div class="text-center my-4">
        <button class="btn-success btn-sm text-white me-2" [disabled]="addgrnform.invalid"
          [ngClass]="{'primary-button': !addgrnform.invalid,'secondary-button': addgrnform.invalid}"
          (click)="onsubmit()">
          <i class="fas fa-check text-white fs-5"></i> &nbsp; Submit
        </button> &nbsp;
        <button class="btn-primary btn-sm text-white me-4"  routerLink="/pmr/PmrTrnGrninwardadd" data-bs-dismiss="modal">
                <i class="fas fa-close text-white"></i> &nbsp;Back
            </button>

      </div>
    </form>
  </div>
</div>