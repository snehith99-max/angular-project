<div class="card">

    <div class="card-title p-5 pb-6 pt-6 rounded-top bg-primary">
        <h3 class="fw-bolder text-white"><i class="fas fa-plus fw-bolder fs-3">&nbsp;&nbsp;</i>Raise Enquiry</h3>
    </div>

    <!-- <div class="card card-title bg-primary">
            <h3 class="m-4 text-white">Raise Enquiry</h3>
        </div> -->
    <form [formGroup]="combinedFormData">
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Enquiry Ref. No</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="
                         form-control form-control-lg form-control-solid custom-input
                         mb-3 mb-lg-0  borderc-secondary bg-white custom-input" placeholder="New Reference No"
                        formControlName="enquiry_gid" class="form-control " style="height: 40px;" readonly />
                </div>
            </div>
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Enquiry Date<span class="ms-1 text-red">*</span></span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': combinedFormData.get('enquiry_date')?.hasError('required')
                         && combinedFormData.get('enquiry_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
                        formControlName="enquiry_date" class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
                   custom-input date-picker " placeholder="DD-MM-YYYY" style="height: 40px;" />
                </div>
            </div>


            <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"><b>Enquiry Date</b> <span class="ms-1 text-red">*</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="date" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input date-picker
                " placeholder="" formControlName="enquiry_date" class="form-control" style="height: 40px;" />
                    </div>
                </div> -->




            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold required">Branch</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <ng-select formControlName="branch_name" [(ngModel)]="mdlBranch" [class.is-invalid]="
                    branch_name.invalid && (branch_name.dirty || branch_name.touched)
                      " [ngClass]="{'invalid-border': branch_name.invalid && branch_name.touched}"
                        [items]="branch_list" required class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2"
                        bindLabel="branch_name" bindValue="branch_gid" placeholder="Select an option"></ng-select>
                    <div *ngIf="
                    branch_name.invalid && (branch_name.dirty || branch_name.touched)
                      " class="invalid-feedback">
                        <div *ngIf="branch_name.errors?.['required']">
                            Branch is required.
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Vendor Enquiry Ref. No</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0  borderc-secondary bg-white custom-input" style="height: 40px;"
                        placeholder="Vendor Enquiry Ref. No" formControlName="enquiry_referencenumber"
                        class="form-control" />
                </div>
            </div>

            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold required">Vendor Name</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <ng-select formControlName="vendor_companyname" [(ngModel)]="mdlcus" [class.is-invalid]="
                    vendor_companyname.invalid && (vendor_companyname.dirty || vendor_companyname.touched)
                      " [ngClass]="{'invalid-border': vendor_companyname.invalid && vendor_companyname.touched}"
                        [items]="GetVendor_list" required (clear)="OnClearVendor()"
                        class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="vendor_companyname"
                        (change)="GetOnChangeCustomerName()" placeholder="Select an option"></ng-select>
                    <div *ngIf="
                    vendor_companyname.invalid && (vendor_companyname.dirty || vendor_companyname.touched)
                      " class="invalid-feedback">
                        <div *ngIf="vendor_companyname.errors?.['required']">
                            Vendor Name is required.
                        </div>
                    </div>

                </div>
            </div>

            <!-- <input formControlName="vendor_gid" hidden
                placeholder="Address Line 1"  type="text" class="
                    form-control form-control-lg form-control-solid
                    bg-white
                    custom-input
                    mb-3 mb-lg-0
                    borderc-secondary
                  " name="vendor_gid" /> -->
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Vendor Branch</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input 
                    mb-3 mb-lg-0   custom-input" readonly [(ngModel)]="txtvendorbranch_name" formControlName="vendorbranch_name" style="height: 40px;"
                        class="form-control bg-secondary" />

                </div>
            </div>
        </div>
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Contact Person</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="form-control bg-secondary" style="height: 40px;"
                        formControlName="contactperson_name" [(ngModel)]="txtcontactperson_name" readonly>
                </div>
            </div>
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Contact Number</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0   bg-secondary custom-input" style="height: 40px;"
                        formControlName="contact_telephonenumber" [(ngModel)]="txtcontact_telephonenumber" class="form-control bg-secondary" />
                </div>
            </div>

            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold"> Email ID</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="form-control bg-secondary" style="height: 40px;"
                        formControlName="email_id" [(ngModel)]="txtemail_id" readonly>
                </div>
            </div>
        </div>
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Address</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <textarea type="text" class="form-control bg-secondary" [(ngModel)]="txtaddress1" formControlName="address1"
                        readonly></textarea>
                </div>
            </div>
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Vendor Requirment</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="vendor_requirement"
                        class="form-control"></textarea>
                </div>
            </div>


            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Expected Closure Date<span class="ms-1 text-red">*</span></span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': combinedFormData.get('closure_date')?.hasError('required')
                         && combinedFormData.get('closure_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
                        formControlName="closure_date" class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
                   custom-input date-picker " placeholder="DD-MM-YYYY" style="height: 40px;" />
                </div>
            </div>


            <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"><b>Expected Closure Date</b>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="date" class="
            form-control form-control-lg form-control-solid custom-input
            mb-3 mb-lg-0  borderc-secondary bg-white custom-input" style="height:40px;" formControlName="closure_date"
                            class="form-control" />
                    </div>
                </div> -->


            <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"><b>Enquiry Assigned To</b><span
                        class="ms-1 text-red">*</span>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="user_firstname" [items]="assign_list" required
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="user_firstname"
                            bindValue="employee_gid" placeholder="Select an option"
                            [(ngModel)]="mdlEmployee"></ng-select>
                    </div>
                </div> -->

        </div>
        <!-- <div class="d-flex flex-row m-6 flex-wrap">
                
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><b>Landmark</b>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="landmark"
                            class="form-control"></textarea>
                    </div>
                </div> 
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><b>Enquiry Rating</b>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="customer_rating" required
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2"
                            placeholder="Select an option" [(ngModel)]="mdlEnq">
                            <ng-option value="Cold">Cold</ng-option>
                            <ng-option value="Warm">Warm</ng-option>
                            <ng-option value="Hot">Hot</ng-option>
                        </ng-select>
                    </div>
                </div>
            </div> -->
        <div class="d-flex flex-row m-6 flex-wrap">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Enquiry Remarks</span>
                <div class="col-lg-11 col-12 col-md-12 col-sm-11 fv-row mt-2">
                    <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="enquiry_remarks"
                        class="form-control"></textarea>
                </div>
            </div>

        </div>

        <!--product summary-->
        <form [formGroup]="productform" (ngSubmit)="productSubmit()">
            <table id="products_list" class="table table-striped table-row-bordered gy-5 gs-7 ">
                <thead>
                    <tr class="fw-bold fs-5 text-nowrap bg-lightblue text-blue">

                        <!-- <th>Vendor Product Code<span class="ms-1 text-red">*</span></th> -->
                        <th>&nbsp;&nbsp;&nbsp;&nbsp; Product Name<span class="ms-1 text-red">*</span></th>
                        <th>&nbsp;&nbsp;Product Group</th>
                        <th>&nbsp;&nbsp;Product Code</th>
                        <th>&nbsp;Unit</th>
                        <th>Qty Requested<span class="ms-1 text-red">*</span></th>
                        <th>Potential value<span class="ms-1 text-red">*</span></th>
                        <th>Need By Date<span class="ms-1 text-red">*</span></th>
                        <th class="align-center">Action</th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <!-- <td>
                                        <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                            <input type="text" class="
                                            form-control form-control-lg form-control-solid custom-input
                                            mb-3 mb-lg-0  borderc-secondary bg-white custom-input" style="height: 40px;" formControlName="vendorproduct_code"
                                            class="form-control" />

                                        </div>
                                    </td> -->
                        <td>
                            <div class="container">

                                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                    <ng-select formControlName="product_name" [items]="products_list1" required
                                        class="custom col-lg-12 col-12 col-md-11 col-sm-10 fv-row mt-2"
                                        bindLabel="product_name" style="height:40px;" placeholder="Select an option"
                                        (change)="GetOnChangeProductsName()" (clear)="OnClearProduct()"
                                        [(ngModel)]="mdlproduct"></ng-select>
                                </div>

                                <div class="row">
                                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                        <textarea type="text" class="
                                            form-control form-control-lg form-control-solid custom-input
                                            mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
                                            formControlName="display_field" class="form-control"></textarea>
                                    </div>
                                </div>
                            </div>
                        </td>


                        <!--Product Group Dropdown-->
                        <td>
                            <div class="col-lg-15 col-6 col-md-12 col-sm-12 fv-row mt-2">
                                <input type="text" class="form-control" formControlName="productgroup_name" readonly
                                    style="background-color: #e9e7e7;height:40px;" [(ngModel)]="txtproductgroup_name">
                            </div>
                        </td>
                        <!--Customer Product Code-->

                        <!--Product Code-->
                        <td>
                            <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                <input type="text" class="form-control" formControlName="product_code" readonly
                                    style="background-color: #e9e7e7;height:40px;" [(ngModel)]="txtproductcode">
                            </div>
                        </td>
                        <!--Product Name-->

                        <!--Unit-->
                        <td>
                            <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                <input type="text" class="form-control" formControlName="productuom_name" readonly
                                    style="background-color: #e9e7e7;height:40px;" [(ngModel)]="txtunit">
                            </div>
                        </td>
                        <!--Requested Quantity-->
                        <td>
                            <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                <input type="text" class="
                                            form-control form-control-lg form-control-solid custom-input
                                            mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
                                    formControlName="qty_requested" style="height: 40px;" class="form-control" />
                            </div>
                        </td>
                        <!--Potential Value-->
                        <td>
                            <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                <input type="text" class="
                                    form-control form-control-lg form-control-solid custom-input
                                    mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
                                    formControlName="potential_value" [(ngModel)]="potential_value" class="form-control"
                                    style="height:40px;" />
                            </div>
                        </td>
                        <!--Need by Date-->
                        <td>
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                        <input type="date" pattern="^(?!\s*$).+"
                                            [ngStyle]="{ 'border-color': productform.get('product_requireddate')?.hasError('required')
                                              && productform.get('product_requireddate')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
                                            formControlName="product_requireddate" class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
                                               custom-input date-picker " placeholder="DD-MM-YYYY"
                                            style="height: 40px;" />


                                        <!-- <input type="date" class="
                                                form-control form-control-lg form-control-solid custom-input
                                                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="product_requireddate"
                                                        class="form-control" /> -->
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                                        <textarea type="text" class="
                                            form-control form-control-lg form-control-solid custom-input
                                            mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
                                            formControlName="product_requireddateremarks"
                                            class="form-control"></textarea>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td class="text-center text-nowrap">
                            <button title="Add" type="button" class="btn btn-icon btn-sm bg-success me-2"
                                (click)="productSubmit()">
                                <span Class="fa-solid fa-plus text-white  fs-6"></span></button>
                            <!-- <button title="Update" type="button" (click)="onupdate()"                                        
                                            class="btn btn-icon btn-sm bg-primary me-1"><span
                                                class="fa-solid fa-arrow-up text-white  fs-6"></span></button> -->
                        </td>
                    </tr>
                </tbody>
            </table>

        </form>
        <table id="POproductlist" class="table table-striped table-row-bordered gy-5 gs-7 ">
            <thead>
                <tr class="fw-bold fs-5 text-nowrap bg-lightblue text-blue">
                    <!-- <th>Vendor Product Code</th> -->
                    <th>Product</th>
                    <th>Product Group</th>
                    <th>Product Code</th>
                    <th>Unit</th>
                    <th>Qty Requested</th>
                    <th>Potential value</th>
                    <th>Need By Date</th>
                    <th class="align-center">Action</th>
                </tr>
            </thead>
            <tbody>


                <tr *ngFor="let data of POproductlist; ">
                    <!--Product Group Dropdown-->
                    <!-- <td>{{data.vendorproduct_code}}</td> -->
                    <td>{{data.product_name}}<br>{{data.display_field}}</td>
                    <td>{{data.productgroup_name}}</td>
                    <td>{{data.product_code}}</td>
                    <td>{{data.productuom_name}}</td>
                    <td>{{data.qty_requested}}</td>
                    <td>{{data.potential_value}}</td>
                    <td>{{data.product_requireddate}}<br>{{data.product_requireddateremarks}}</td>
                    <td>
                        <button title="Delete" type="button" (click)="openModaldelete(data.tmpsalesenquiry_gid)"
                            data-bs-toggle="modal" data-bs-target="#myModaldeletes"
                            class="btn btn-icon btn-sm bg-danger me-1"><span
                                class="fa-solid fa-trash text-white  fs-6"></span></button>&nbsp;
                        <!-- <button title="Edit" type="button" (click)="openModaledit(data.tmpsalesenquiry_gid)"
                                            data-bs-toggle="modal" data-bs-target="#myModaledits"
                                            class="btn btn-icon btn-sm bg-warning me-1"><span
                                                class="fa-solid fa-pencil text-white  fs-6"></span></button> -->

                    </td>
                </tr>
            </tbody>
        </table>






        <div class="modal" id="myModaldeletes" data-bs-backdrop="static" data-bs-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="text-center my-4">
                        <h2><b>Are you sure?</b></h2>
                        <br>
                        <p style="display: block;">Do You Want To Delete the Record ?</p>
                        <div class="text-center my-4">
                            <button class="btn-primary btn-sm text-white me-2" data-bs-dismiss="modal">
                                <i class="fas fa-close text-white"></i> &nbsp;Close
                            </button>&nbsp;
                            <button class="btn-danger btn-sm text-white me-4" (click)="ondelete()"
                                data-bs-dismiss="modal">
                                <i class="fas fa-trash text-white fs-5 "></i> &nbsp;Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center my-4">
            <!-- <button type="submit" class="btn-success btn-sm text-white me-2">
                <i class="bi bi-check-square fs-5"></i>
                <span class="ms-3">Submit</span> </button> -->
            <button type="submit" (click)="onSubmit()" class="btn-success btn-sm text-white me-2"
                [disabled]="combinedFormData.invalid"
                [ngClass]="{'primary-button': !combinedFormData.invalid,'secondary-button': combinedFormData.invalid}">
                <i class="fa fa-check fs-5"></i>&nbsp;Submit</button>
            <button class="btn-primary btn-sm text-white me-4" (click)="onclose()">
                <i class="ki-duotone ki-entrance-right fs-5">
                    <i class="path1"></i>
                    <i class="path2"></i>
                </i>&nbsp;Back</button>
        </div>
    </form>

</div>