<div class="container-fluid">
  <div class="row">
    <div class="col-md-3">
      <div style="cursor: pointer;">
        <div class="card inbox-card" style="overflow-y: auto;overflow-x: auto;" (click)="actionmenu2()"  (click)="actionmenu()"  (click)="actionmenu1()">
          <div class="card-header bg-primary text-white" style="position: relative; display: flex; justify-content: space-between; align-items: center;">
            <h5 style="font-weight: bold; margin: 0; color: white;">Mail Folder</h5>
            <div style="cursor: pointer;">
              <button class="btn me-2 p-1" (click)="$event.stopPropagation(); showOptions1 = !showOptions1">
                <span class="fa-solid fa-ellipsis-vertical fs-1" style="color: white;"></span>
              </button>
    
              <div *ngIf="showOptions1" class="pb-0 rounded bg-white cursor-pointer icon_menu" >
                <!-- Add Icons -->
                <div (click)="moveToFolder()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal" data-bs-target="#myModaladd" (click)="$event.stopPropagation(); selectAction('add'); showOptions1 = false">
                  <span><i class="fa-solid fa-plus-circle fs-3 me-5"></i></span>
                  <span [ngClass]="{'selected': selectedAction === 'add'}">Add Folder</span>
                </div>
              </div>
            </div>
          </div>
    
          <div class="card-body inbox-list">
            <div class="d-flex justify-content-between align-items-center mb-3" style="margin-top: -15px;">
              <div class="d-flex align-items-center">
                <!-- You can add any header controls here -->
              </div>
            </div>
    
            <ul class="list-group">
              <div *ngIf="!folders || folders.length === 0" class="text-center" style="margin-top: 190px;">
                <span style="font-size: 20px;">No Folder Exist</span>
                <br><br><br><br><br><br><br><br><br>
              </div>
              <!-- Folder list -->
              <li class="list-group-item" *ngFor="let folder of folders" style="margin-left: -20px;width: auto;" (click)="selectFolder(folder)" [ngClass]="{'highlight-folder': selectedFolder?.s_no === folder.s_no}">
                <div style="display: flex; align-items: center;">
                  <i class="fas fa-folder folder-icon" style="font-size: 12px; margin-right: 5px;"></i>
                  <span class="text-nowrap">{{ folder.label_name }}</span>
                  <!-- Add edit and delete button icons only for the selected folder -->
                  <span class="icons ml-auto" *ngIf="selectedFolder?.s_no === folder.s_no">
                    <i class="fa fa-edit" title="Edit" style="font-size: 12px; cursor: pointer;" data-bs-toggle="modal" data-bs-target="#myModaledit" (click)="editFolder(folder)"></i>
                   &nbsp; <i class="fa fa-trash ml-2" title="Delete" style="font-size: 12px; cursor: pointer;" data-bs-toggle="modal" data-bs-target="#myModaldelete" (click)="deleteFolder(folder)"></i>
                  </span>
                </div>
              </li>
              
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-3">
      <div class="card inbox-card" (click)="actionmenu2()"  (click)="actionmenu()"  (click)="actionmenu1()"
        (click)="$event.stopPropagation(); showOptions = false">
        <div class="card-header bg-primary text-white"
          style="display: flex; justify-content: space-between; align-items: center;">
          <h5 style="font-weight: bold; margin: 0; color: white;"> Inbox</h5>
          <div style="cursor: pointer;">
            <button class="btn me-2 p-1" (click)="$event.stopPropagation(); showOptions =!showOptions">
              <span class="fa-solid fa-ellipsis-vertical fs-1" style="color: white;"></span>
            </button>

            <div *ngIf="showOptions" class="pb-0 rounded bg-white cursor-pointer icon_menu">
              <!-- Add Icons -->
              <div (click)="moveToFolder()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal"
                data-bs-target="#myModaladddetails"
                (click)="$event.stopPropagation(); selectAction('add'); showOptions = false">
                <span><i class="fa-solid fa-folder fs-3 me-5"></i></span>
                <span [ngClass]="{'selected': selectedAction === 'add'}">Folder To Folder</span>
              </div>

              <!-- <div (click)="tagcustomer()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal" data-bs-target="#myModaledits" (click)="$event.stopPropagation(); selectAction('edit'); showOptions = false">
                <span><i class="fa-solid fa-tag fs-3 me-5"></i></span>
                <span [ngClass]="{'selected': selectedAction === 'edit'}">Tag To Customer</span>
              </div>
              <div (click)="untagcustomer()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal" data-bs-target="#myModaleditsss" (click)="$event.stopPropagation(); selectAction('edit'); showOptions = false">
                <span><i class="fa-solid fa-unlink fs-3 me-5"></i></span>
                <span [ngClass]="{'selected': selectedAction === 'edit'}">Untag From Customer</span>
              </div> -->
              <div (click)="moveToTrash()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal"
                data-bs-target="#myModaldeletes"
                (click)="$event.stopPropagation(); selectAction('delete'); showOptions = false">
                <span><i class="fa-regular fa-trash-can fs-3 me-5"></i></span>
                <span [ngClass]="{'selected': selectedAction === 'delete'}">Move To Trash</span>
              </div>
              <!-- Add Icons -->
            </div>
          </div>
        </div>
        <div class="card-body inbox-list" (click)="$event.stopPropagation(); showOptions = false">
          <div class="d-flex justify-content-between align-items-center mb-3" style="margin-top: -15px;">
            <!-- Show entries dropdown and Search input in the same row -->
            <div class="d-flex align-items-center">
              <!-- <label for="itemsPerPageSelect" class="me-1">Show</label> -->
              <!-- Show entries dropdown -->
              <div class="form-group text-nowrap me-3 text-center" style="margin-left: -19px;">
                <select id="itemsPerPageSelect" class="form-control" [(ngModel)]="itemsPerPage"
                  (ngModelChange)="onItemsPerPageChange()" style="width: 43px;height: 30px;text-align: center; text-align-last: center; ">
                  <option *ngFor="let option of itemsPerPageOptions" [value]="option">{{ option }}</option>
                </select>
              </div>

              <div class="search-container" style="margin-left: -4px;">
                <div class="search-wrapper">
                  <i class="search-icon fas fa-search"></i>
                  <input type="text" class="search-input" placeholder="Search mail" 
                         [(ngModel)]="searchTerm" (input)="searchEmails()">
                </div>
              </div>
              <!-- Search input -->
              <!-- <div class="input-group" style="width: 200px;margin-left: 0px;">
                <input type="text" class="form-control" placeholder="Search Emails"  style="height: 30px;"  [(ngModel)]="searchTerm"
                  (input)="searchEmails()">
              </div> -->
            </div>
          </div>
          <ul class="list-group">
            <div *ngIf="paginatedEmails && paginatedEmails.length === 0" class="text-center" style="margin-top: 160px;">
              <span style="font-size: 20px;">No Conversations Here</span>
              <br> <br> <br> <br> <br> <br> <br> <br> <br>
            </div>
            <li class="list-group-item" style="margin-left: -25px;" *ngFor="let email of paginatedEmails"
              (click)="selectEmail(email)" [class.active]="selectedEmail === email"
              (mouseenter)="email.isHovered = true" (mouseleave)="email.isHovered = false">
              <div class="email-item d-flex align-items-center">
                <input type="checkbox"
                  (click)="$event.stopPropagation(); showOptions = false; toggleCheck(email, $event)"
                  [(ngModel)]="email.checked" style="margin-right: 10px;" *ngIf="email.isHovered || email.checked">
                <i class="fas fa-envelope" [class.hidden]="email.isHovered || email.checked"
                  style="font-size: 18px; margin-right: 10px;"></i>
                  <div class="email-details" style="margin-left: -2px;">
                    <ng-container *ngIf="email.sent_date && email.sent_date.trim() !== ''; else noDate">
                      <div>
                        <small>
                          {{ email.from_id.length > 30 ? email.from_id.substring(0, 30) + '...' : email.from_id }}
                          - </small>
                        <br *ngIf="email.sent_date">
                        <small *ngIf="email.sent_date">
                          {{ email.sent_date }}</small>
                      </div>
                      
                    </ng-container>
                    <ng-template #noDate>
                      <div>
                      <small>{{ email.from_id }}</small>
                    </div>
                    </ng-template>
                    <label *ngIf="email.read_flag == 'false' || email.read_flag == 'False'" style="font-size: 10px; min-width: 200px;">
                      {{ email.subject.length > 30 ? email.subject.substring(0, 30) + '...' : email.subject }}
                    </label>
                    <h6 *ngIf="email.read_flag == 'true' || email.read_flag == 'True'" style="font-size: 10px; font-weight: bold; min-width: 200px;">
                      <b>{{ email.subject.length > 30 ? email.subject.substring(0, 30) + '...' : email.subject }}</b>
                    </h6>
                    <h6 *ngIf="email.read_flag === null || email.read_flag === 'null' || email.read_flag === ''" style="font-size: 10px; font-weight: bold; min-width: 200px;">
                      <b>{{ email.subject.length > 30 ? email.subject.substring(0, 30) + '...' : email.subject }}</b>
                    </h6>
                    
                    
                    
                    
                
                  </div>
                <!-- <div class="tag-untag-btn"  style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);">
              <i title="Tag" class="fa-solid fa-tag fs-3 me-5"
                 *ngIf="selectedEmail === email"
                 (click)="$event.stopPropagation(); tagEmail(email);"
                 style="font-size: 20px; margin-right: 10px; color: white; cursor: pointer;"></i>
              <i title="Untag" class="fa-solid fa-unlink fs-3 me-5"
                 *ngIf="selectedEmail === email "
                 (click)="$event.stopPropagation(); untagEmail(email);"
                 style="font-size: 20px; margin-right: 10px; color: white; cursor: pointer;"></i>
            </div> -->
           <div *ngIf="selectedEmail === email" style="cursor: pointer;">
                &nbsp;  &nbsp;   <button style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);"
                    class="btn me-2 p-1" (click)="$event.stopPropagation(); showOptions2 =!showOptions2">
                    <span class="fa-solid fa-ellipsis-vertical fs-1" style="color: white;"></span>
                  </button>

                  <div *ngIf="showOptions2" class="pb-0 rounded bg-white cursor-pointer icon_menu">
                    <!-- Add Icons -->
                    <div (click)="tagEmail(email)" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal"
                      data-bs-target="#myModaledittagcustomers"
                      (click)="$event.stopPropagation(); selectAction('add'); showOptions2 = false">
                      <span><i class="fa-solid fa-tag fs-3 me-5"></i></span>
                      &nbsp;<span [ngClass]="{'selected': selectedAction === 'add'}">Tag Customer</span>
                    </div>

                    <div (click)="untagEmail(email)" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal"
                      data-bs-target="#myModaleditsssdsdsfd"
                      (click)="$event.stopPropagation(); selectAction('edit'); showOptions2 = false">
                      <span><i class="fa-solid fa-unlink fs-3 me-5"></i></span>
                      <span [ngClass]="{'selected': selectedAction === 'edit'}">Untag Customer</span>
                    </div>
                    <!-- <div (click)="tagcustomer()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal" data-bs-target="#myModaledit" (click)="$event.stopPropagation(); selectAction('edit'); showOptions = false">
                  <span><i class="fa-solid fa-tag fs-3 me-5"></i></span>
                  <span [ngClass]="{'selected': selectedAction === 'edit'}">Tag To Customer</span>
                </div>
                
                <div (click)="moveToTrash()" class="d-flex p-3 pb-3 Icon_hover" data-bs-toggle="modal" data-bs-target="#myModaldelete" (click)="$event.stopPropagation(); selectAction('delete'); showOptions = false">
                  <span><i class="fa-regular fa-trash-can fs-3 me-5"></i></span>
                  <span [ngClass]="{'selected': selectedAction === 'delete'}">Move To Trash</span>
                </div> -->

                    <!-- Add Icons -->
                  </div>
                </div>
              </div>
            </li>
          </ul>

          <!-- Pagination component -->
          <pagination class="text-nowrap" style="float: left;" [boundaryLinks]="false" [maxSize]="8"
            [totalItems]="filteredEmails.length" [itemsPerPage]="itemsPerPage" [(ngModel)]="currentPage"
            (pageChanged)="pageChanged($event)" [directionLinks]="true" previousText="Previous" nextText="Next">
          </pagination>
        </div>

      </div>
    </div>
    <div class="col-md-6">
      <div class="card reply-card" (click)="actionmenu2()" (click)="actionmenu1()" (click)="actionmenu()">
        <div class="card-header bg-primary text-white"
          style="display: flex; justify-content: space-between; align-items: center;">
          <div style="display: flex; align-items: center;">
            <div class="sender-initial" *ngIf="selectedEmail">{{ getSenderInitial(getEmailFromId(selectedEmail.from_id))
              }}</div>
            <h5 style="font-weight: bold; margin: 0; color: white;" *ngIf="selectedEmail">{{
              getEmailFromId(selectedEmail.from_id) }}</h5>
          </div>
          <div class="d-flex justify-content-end align-items-start mt-n2">
            <i class="fas fa-arrow-left fs-1 ms-3 mt-4 circular-icon text-black" title="Back" (click)="onbacks()" style="cursor: pointer;"></i>
        </div>
        </div>

        <div style="overflow-y: auto;"  #scrollContainer>
          <div *ngIf="selectedEmail; else noEmailSelected">
            <div class="d-flex flex-column position-relative email-card">
              <div class="position-absolute top-0 end-0 d-flex align-items-center">
                <span class="ms-2">{{ selectedEmail.sent_time }}</span> &nbsp; &nbsp;&nbsp;&nbsp;
                <button (click)="replyButtonClicked(selectedEmail)" class="btn btn-link">
                  <b><i title="Reply" class="fas fa-reply"></i></b>
                </button> &nbsp; &nbsp;&nbsp;&nbsp;
                <button (click)="forwardButtonClicked(selectedEmail,'inbox')" class="btn btn-link">
                  <b><i title="Forward" class="fas fa-share"></i></b>
                </button> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
              </div>
              <div class="email-card-content">
                <div>
                  <span class="label">From:</span> {{ selectedEmail.from_id }}
                </div>
                <div>
                  <span class="label">To:</span> {{ selectedEmail.integrated_gmail }}
                </div>
                <div *ngIf="selectedEmail.cc">
                  <span class="label">Cc:</span> {{ selectedEmail.cc }}
                </div>
                <div *ngIf="selectedEmail.bcc">
                  <span class="label">Bcc:</span> {{ selectedEmail.bcc }}
                </div>
                <div>
                  <span class="label">Date:</span> {{ selectedEmail.sent_date }}
                </div>
                <div>
                  <span class="label">Subject:</span> {{ selectedEmail.subject }}
                </div>

              </div>

              <div *ngIf="selectedEmail.attachement_flag!='N'" class="attachment-container">
                <div class="text-center" *ngFor="let attachment of gmailapiinboxatatchement_list; let i = index"
                  class="attachment" (mouseover)="onMouseOver(attachment, i)" (mouseleave)="onMouseLeave()">

                  <div class="attachment-thumbnail text-center">
                    <i [class]="getIconClass(attachment.original_filename)"
                      style="font-size: 18px;text-align: center;"></i>
                  </div>

                  <div class="attachment-info-wrapper">
                    <div class="attachment-info">
                      <span class="text-nowrap">{{ attachment.original_filename }}</span>
                    </div>
                  </div>

                  <button *ngIf="hoveredAttachment === attachment" (click)="downloadAttachment(attachment)"
                    class="download-button">
                    <i class="fas fa-download"></i>
                  </button>
                </div>
              </div>

              <div style="text-align: left; overflow-x: hidden; padding-right: 10px;margin-top: -20px;">
                <span [innerHTML]="second" style="margin-left: 6px; font-size: 12px;"></span>
              </div>
            </div>
          </div>
          <div style="margin-top: -5px;"
            *ngIf="selectedReplmails && selectedReplmails.length > 0; else noReplmailsSelected">
            <h3 class="reply-mail-details">Reply Mail Details</h3>
            <div *ngFor="let email of selectedReplmails" class="email-card">
              <div class="d-flex flex-column position-relative">
                <div class="position-absolute top-0 end-0 d-flex align-items-center">
                  <span class="ms-2">{{ email.sent_time }}</span>
                  <div class="email-actions flex-row">
                    <!-- <button class="btn btn-link">
                    <b><i title="Reply" class="fas fa-reply"></i></b>
                  </button> -->
                    <button class="btn btn-link" (click)="forwardButtonClicked(email,'reply')">
                      <b><i title="Forward" class="fas fa-share"></i></b>
                    </button>
                  </div>
                </div>
              </div>
              <div class="email-body">
                <div class="email-card-content">
                  <div>
                    <span class="label">To:</span> {{ email.from_id }}
                  </div>
                  <div *ngIf="email.cc">
                    <span class="label">Cc:</span> {{ email.cc }}
                  </div>
                  <div *ngIf="email.bcc">
                    <span class="label">Bcc:</span> {{ email.bcc }}
                  </div>
                  <div>
                    <span class="label">Date:</span> {{ email.sent_date }}
                  </div>
                  <div>
                    <span class="label">Subject:</span> {{ email.subject }}
                  </div>

                </div>

                <div *ngIf="email.attachement_flag!='N'" class="attachment-container">
                  <div class="text-center" *ngFor="let attachment of email.attachments; let i = index"
                    class="attachment" (mouseover)="onMouseOver(attachment, i)" (mouseleave)="onMouseLeave()">

                    <div class="attachment-thumbnail text-center">
                      <i [class]="getIconClass(attachment.original_filename)"
                        style="font-size: 18px;text-align: center;"></i>
                    </div>

                    <div class="attachment-info-wrapper">
                      <div class="attachment-info">
                        <span class="text-nowrap">{{ attachment.original_filename }}</span>
                      </div>
                    </div>

                    <button *ngIf="hoveredAttachment === attachment" (click)="downloadAttachment(attachment)"
                      class="download-button">
                      <i class="fas fa-download"></i>
                    </button>
                  </div>
                </div>
                <!-- <div class="email-body-text" style="text-align: left;">
                  <span [innerHTML]="email.body" style="max-width: 90px; display: inline-block; margin-left: 6px;"></span>
                </div> -->
                <div style="text-align: left;">
                  <span [innerHTML]="email.body"
                    style="display: inline-block; margin-left: 6px;"></span>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noReplmailsSelected>
            <!-- <p>No emails selected for reply.</p> -->
          </ng-template>
          <div style="margin-top: -5px;"
            *ngIf="selectedFwdmails && selectedFwdmails.length > 0; else noFwdmailsSelected">
            <h3 class="reply-mail-details">Forward Mail Details</h3>
            <div *ngFor="let email of selectedFwdmails" class="email-card">
              <div class="d-flex flex-column position-relative">
                <div class="position-absolute top-0 end-0 d-flex align-items-center">
                  <span class="ms-2">{{ email.sent_time }}</span>
                  <div class="email-actions flex-row">
                    <!-- <button class="btn btn-link">
                    <b><i title="Reply" class="fas fa-reply"></i></b>
                  </button> -->
                    <button class="btn btn-link" (click)="forwardofButton(email,'reply')">
                      <b><i title="Forward" class="fas fa-share"></i></b>
                    </button>
                  </div>
                </div>
              </div>
              <div class="email-body">
                <div class="email-card-content">
                  <div>
                    <span class="label">To:</span> {{ email.to_id }}
                  </div>
                  <div>
                    <span class="label">Date:</span> {{ email.sent_date }}
                  </div>
                  <div>
                    <span class="label">Subject:</span> {{ email.subject }}
                  </div>

                </div>

                <div *ngIf="email.attachement_flag!='N'" class="attachment-container">
                  <div class="text-center" *ngFor="let attachment of email.attachments; let i = index"
                    class="attachment" (mouseover)="onMouseOver(attachment, i)" (mouseleave)="onMouseLeave()">

                    <div class="attachment-thumbnail text-center">
                      <i [class]="getIconClass(attachment.original_filename)"
                        style="font-size: 18px;text-align: center;"></i>
                    </div>

                    <div class="attachment-info-wrapper">
                      <div class="attachment-info">
                        <span class="text-nowrap">{{ attachment.original_filename }}</span>
                      </div>
                    </div>

                    <button *ngIf="hoveredAttachment === attachment" (click)="downloadAttachment(attachment)"
                      class="download-button">
                      <i class="fas fa-download"></i>
                    </button>
                  </div>
                </div>
                <!-- <div class="email-body-text" style="text-align: left;">
                  <span [innerHTML]="email.body" style="max-width: 90px; display: inline-block; margin-left: 6px;"></span>
                </div> -->
                <div style="text-align: left;">
                  <span [innerHTML]="email.body"
                    style="display: inline-block; margin-left: 6px;"></span>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noFwdmailsSelected>
            <!-- <p>No emails selected for reply.</p> -->
          </ng-template>
          <div class="d-flex flex-column position-relative email-card" *ngIf="selectedEmail">
            <div>
              <div class="tab-container" style="margin-top: 10px;">
                <div class="tab" #emailTab [ngClass]="{'active': isEmailTabActive}" (click)="toggleTab('email')">
                  <i class="fas fa-envelope"></i> Email
                </div>
                <div class="tab" [ngClass]="{'active': isCommentTabActive}" (click)="toggleTab('comment')">
                  <i class="fas fa-comment"></i> Comment
                </div>
              </div>
              <div class="email-tab-content" *ngIf="isEmailTabActive">
                <div>
                  <div *ngIf="isReply" style="display: flex; align-items: center; margin-bottom: 5px;">
                    <b style="margin-right: 10px;">To:</b>&nbsp;&nbsp;
                    <input type="text" class="form-control" [(ngModel)]="replytoid" style="width: 580px;" [ngClass]="{ 'invalid-input': !validateEmails(replytoid) }" />
                  
                  
                  </div>
                  <div *ngIf="!validateEmails(replytoid)" style="color:red;margin-left: 20px;">
                     
                    Invaild To Email Format.</div>
                  
                
                  <div *ngIf="isReply">
          
                    <div *ngIf="selectedEmail.cc" style="display: flex; align-items: center; margin-bottom: 5px;">
                      <b style="margin-right: 10px;">Cc:</b>&nbsp;&nbsp;
                      <input type="text" class="form-control" [(ngModel)]="replyccid" style="width: 580px;" [ngClass]="{ 'invalid-input':!validateEmails(replyccid) }" />
                     
                    </div>
                    <div *ngIf="selectedEmail.cc" >
                      <div *ngIf="!validateEmails(replyccid)" style="color:red;margin-left: 20px;">
                        Invalid Cc Email Format.
                      </div>
                    </div>
                    
                    <div *ngIf="!selectedEmail.cc" style="display: flex; align-items: center; margin-bottom: 5px;">
                      <b style="margin-right: 10px;">Cc:</b>&nbsp;&nbsp;
                      <input type="text" class="form-control" [(ngModel)]="replyccid" style="width: 580px;" 
                             [ngClass]="{ 'invalid-input': replyccid &&!validateEmails(replyccid) }" />
                      
                    </div>
                    <div *ngIf="!selectedEmail.cc">
                      <div *ngIf="replyccid &&!validateEmails(replyccid)" style="color:red;margin-left: 20px;">
                        Invalid Cc Email Format.
                      </div>
                    </div>
                    <div *ngIf="selectedEmail.bcc" style="display: flex; align-items: center; margin-bottom: 5px;">
                      <b style="margin-right: 10px;">Bcc:</b>
                      <input type="text" class="form-control" [(ngModel)]="replybccid" style="width: 580px;" [ngClass]="{ 'invalid-input':!validateEmails(replybccid) }" />
                     
                    </div>
                    <div *ngIf="selectedEmail.bcc" >
                      <div *ngIf="!validateEmails(replybccid)" style="color:red;margin-left: 20px;">
                        Invalid Cc Email Format.
                      </div>
                    </div>
                    
                    <div *ngIf="!selectedEmail.bcc" style="display: flex; align-items: center; margin-bottom: 5px;">
                      <b style="margin-right: 10px;">Bcc:</b>
                      <input type="text" class="form-control" [(ngModel)]="replybccid" style="width: 580px;" 
                             [ngClass]="{ 'invalid-input': replybccid &&!validateEmails(replybccid) }" />
                      
                    </div>
                    <div *ngIf="!selectedEmail.bcc">
                      <div *ngIf="replybccid &&!validateEmails(replybccid)" style="color:red;margin-left: 20px;">
                        Invalid Cc Email Format.
                      </div>
                    </div>
                  </div>
               
                  <div *ngIf="isForward" style="display: flex; align-items: center; margin-bottom: 5px;">
                    <b style="margin-right: 10px;">To:</b>
                    <input type="text" [(ngModel)]="forwardto" class="form-control" style="width: 580px;" />
                  </div>
                  <div *ngIf="isForwardFwd" style="display: flex; align-items: center; margin-bottom: 5px;">
                    <b style="margin-right: 10px;">To:</b>
                    <input type="text" [(ngModel)]="forwardto" class="form-control" style="width: 580px;" />
                  </div>
                  <div *ngIf="isForward" style="display: flex; align-items: center;">
                    <b style="margin-right: 10px;">Subject: </b>Fwd: {{ subject }}
                  </div>
                  <div *ngIf="isForwardFwd" style="display: flex; align-items: center;">
                    <b style="margin-right: 10px;">Subject: </b>Fwd: {{ subject }}
                  </div>
                  <div *ngIf="isReply" style="display: flex; align-items: center;">
                    <b style="margin-right: 10px;">Subject: </b>Re: {{ selectedEmail.subject }}
                  </div>
                  <div class="comment-body" *ngIf="!isReply && !isForward && !isForwardFwd">
                    <p>Click Reply/Forward Button to Compose Message</p>


                  </div>
                  <div *ngIf="isReply">
                    <b style="margin-right: 10px;">Body: </b>
                    <angular-editor [config]="config_compose_mail" [(ngModel)]="emailBody"></angular-editor>
                  </div>

                  <div class="comment-body" *ngIf="isForward">
                    <b style="margin-right: 10px;">Body: </b>
                    <angular-editor [config]="config_compose_mail" [(ngModel)]="emailBody"></angular-editor>
                  </div>
                  <div class="comment-body" *ngIf="isForwardFwd">
                    <b style="margin-right: 10px;">Body: </b>
                    <angular-editor [config]="config_compose_mail" [(ngModel)]="emailBody"></angular-editor>
                  </div>
                  <div *ngIf="isReply" class="comment-footer d-flex align-items-center justify-content-between">
                    <div class="file-attachment d-flex align-items-center" style="margin-top: 10px;">
                      <label for="file-upload-forward" class="btn btn-secondary mb-0">
                        <i style="font-size: 24px;" class="fas fa-paperclip"></i>
                      </label>
                      <input type="file" id="file-upload-forward" #fileInput name="attachments"
                        accept=".xlsx,image/png,image/jpeg,.docx,.pdf,.txt," style="display: none;" multiple
                        (change)="onFilesSelected($event)">
                      <div class="file-names ms-2">
                        <span *ngFor="let fileName of selectedFileNames" class="file-name d-block">{{ fileName }}</span>
                      </div>
                    </div>
                    <button class="comment-footer" (click)="replyToEmail()">Reply</button>
                  </div>
                  <div *ngIf="isForward" class="comment-footer d-flex align-items-center justify-content-between">
                    <div class="file-attachment d-flex align-items-center">
                    </div>
                    <button class="comment-footer" (click)="forwardToEmail()">Forward</button>


                  </div>
                  <div *ngIf="isForwardFwd" class="comment-footer d-flex align-items-center justify-content-between">
                    <div class="file-attachment d-flex align-items-center">
                    </div>
                    <button class="comment-footer" (click)="forwardToFwdEmail()">Forward</button>


                  </div>
                </div>
              </div>
              <div class="comment-tab-content" *ngIf="isCommentTabActive">
                <div>
                  <!-- <div class="comment-body">
                    <angular-editor [config]="config_compose_mail" formControlName="gmail_body"></angular-editor>
                  </div>
                  <div class="comment-footer">
                    <button>Add comment</button>
                  </div> -->
                  <div class="my-comments-section">
                    <!-- Add Comment Section -->
                    <div class="my-add-comment">
                      <div class="my-card-body" style="margin-top: -16px;">
                        <textarea [(ngModel)]="newComment" class="form-control"
                          placeholder="Type Something..."></textarea>
                        <div class="my-comment-footer">
                          <button (click)="addComment()">Add Comment</button>
                        </div>
                      </div>
                    </div>

                    <!-- Comments List -->
                    <div class="my-comment-list" style="margin-top: -1px;">
                      <div *ngFor="let comment of gmailcomments_list; let i = index"
                        class="my-comment-item card sktblue">
                        <div *ngIf="!comment.isEditing" class="my-comment-text">
                          {{ comment.comments }}
                          <div class="my-actions">
                            <button  title="Edit"  (click)="editComment(i)"><i class="fa fa-edit"
                                style="font-size: 12px;"></i></button>
                            <button  title="Delete" (click)="deleteComment(i)"><i class="fa fa-trash"
                                style="font-size: 12px;"></i></button>
                          </div>
                        </div>
                        <div *ngIf="comment.isEditing" class="my-edit-comment">
                          <textarea class="form-control" style="width:370px" [(ngModel)]="editnewComment"></textarea>
                          <div class="my-actions">
                            <button  title="Save"  (click)="saveComment(i)"><i class="fa fa-save"></i></button>
                            <button  title="Delete"  (click)="deleteComment(i)"><i class="fa fa-trash"></i></button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>




                </div>
              </div>
            </div>
          </div>
          <ng-template #noEmailSelected>
            <div class="text-center" style="margin-top: 160px;">
              <span style="font-size: 28px;">No Open Conversations Here</span>
              <p style="font-size: 18px;">You're all caught up.</p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>

  </div>
</div>
<form [formGroup]="reactiveFormFolder" #form="ngForm">
  <div class="modal" id="myModaladd" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Header -->

        <div class="card-header p-1 pb-2 pt-1 rounded-top bg-primary">
          <h2 style="margin-top:10px;color:white;font-weight: bold;">&nbsp;&nbsp;<i
              class="fas fa-plus fw-bolder fs-3"></i> &nbsp;Add Folder </h2>

        </div>
        <!-- Modal body -->
        <div class="modal-body">
          <div class="row"><span class="font-bold"><b>Folder Name </b><span class="ms-1 text-red">*</span></span>
            <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2 d-flex ">

              <!-- <input class="form-control form-control-lg" formControlName="entity_name" pattern="^(?!\s*$).+" type="text" placeholder="Enter Entity" aria-label=".form-control-lg example" autocomplete="off" required  [class.is-invalid]="entity_name.invalid && (entity_name.dirty || entity_name.touched)">
                                               -->
              <input formControlName="labelName" type="text" class="
                                               form-control form-control-lg form-control-solid
                                               custom-input
                                               mb-3 mb-lg-0
                                               bg-white
                                               custom-input
                                             " [ngStyle]="{
                                               'border-color':
                                               labelName.invalid && labelName.touched
                                                   ? 'red'
                                                   : 'rgb(209, 209, 209)'
                                             }" pattern="^(?!\s*$).+" name="labelName" required placeholder="" />
            </div>

          </div>
          <div *ngIf="labelName.invalid && (labelName.dirty || labelName.touched)">
            <div *ngIf="labelName.errors?.['required']">
              <span style="color:red;">Folder Name is required.</span>
            </div>
          </div>
          <div *ngIf="labelName.invalid && (labelName.dirty ||labelName .touched)">
            <div *ngIf="labelName.errors?.['pattern']">
              <span style="color:red;">Invalid Format.</span>
            </div>
          </div>
          <br>
          <!-- Modal footer -->
          <div class="text-center">
            <button (click)="onsubmitfolder()" [disabled]="reactiveFormFolder.invalid"
              [ngStyle]="{ 'cursor': reactiveFormFolder.invalid ? 'not-allowed' : 'pointer'}" [ngClass]="{ 'btn-success': !reactiveFormFolder.invalid,
                      'btn-secondary text-white': reactiveFormFolder.invalid }" data-bs-dismiss="modal">
              <i class="fas fa-check text-white fs-5 "></i> &nbsp;Submit
            </button> &nbsp;&nbsp;
            <button class="btn-danger btn-sm text-white me-4" (click)="onclose()" data-bs-dismiss="modal">
              <i class="fas fa-close text-white"></i> &nbsp;Close
            </button>
          </div>
          <br>
        </div>
      </div>
    </div>
  </div>
</form>
<form [formGroup]="reactiveFormFolderEdit" #form="ngForm">
  <div class="modal" id="myModaledit" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Header -->

        <div class="card-header p-1 pb-2 pt-1 rounded-top bg-primary">
          <h2 style="margin-top:10px;color:white;font-weight: bold;">&nbsp;&nbsp;<i
              class="fa-solid fa-pen-to-square fs-3"></i> &nbsp;&nbsp;Edit Folder </h2>

        </div>
        <!-- Modal body -->
        <div class="modal-body">
          <div class="row"><span class="font-bold"><b>Folder Name </b><span class="ms-1 text-red">*</span></span>
            <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2 d-flex ">

              <!-- <input class="form-control form-control-lg" formControlName="entity_name" pattern="^(?!\s*$).+" type="text" placeholder="Enter Entity" aria-label=".form-control-lg example" autocomplete="off" required  [class.is-invalid]="entity_name.invalid && (entity_name.dirty || entity_name.touched)">
                                             -->
              <input formControlName="labelNameEdit" type="text" class="
                                             form-control form-control-lg form-control-solid
                                             custom-input
                                             mb-3 mb-lg-0
                                             bg-white
                                             custom-input
                                           " [ngStyle]="{
                                             'border-color':
                                             labelNameEdit.invalid && labelNameEdit.touched
                                                 ? 'red'
                                                 : 'rgb(209, 209, 209)'
                                           }" pattern="^(?!\s*$).+" name="labelNameEdit" required placeholder="" />
            </div>

          </div>
          <div *ngIf="labelNameEdit.invalid && (labelNameEdit.dirty || labelNameEdit.touched)">
            <div *ngIf="labelNameEdit.errors?.['required']">
              <span style="color:red;">Folder Name is required.</span>
            </div>
          </div>
          <div *ngIf="labelNameEdit.invalid && (labelNameEdit.dirty ||labelNameEdit .touched)">
            <div *ngIf="labelNameEdit.errors?.['pattern']">
              <span style="color:red;">Invalid Format.</span>
            </div>
          </div>
          <br>
          <!-- Modal footer -->
          <div class="text-center">
            <button (click)="onupdate()" [disabled]="reactiveFormFolderEdit.invalid"
              [ngClass]="{'primary-button': !reactiveFormFolderEdit.invalid,'secondary-button': reactiveFormFolderEdit.invalid}"
              data-bs-dismiss="modal">
              <i class="fas fa-check text-white fs-5 "></i> &nbsp;Update
            </button> &nbsp;&nbsp;
            <button class="btn-danger btn-sm text-white me-4" (click)="onclose()" data-bs-dismiss="modal">
              <i class="fas fa-close text-white"></i> &nbsp;Close
            </button>
          </div>
          <br>
        </div>
      </div>
    </div>
  </div>
</form>
<div class="modal" id="myModaldelete" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="text-center my-4">
        <h2><b>Are you sure?</b></h2>
        <br>
        <p style="display: block;">Do You Want To Delete the Record ?</p><br>
        <div class="text-center my-4">
          <button class="btn-danger btn-sm text-white me-4" (click)="ondelete()" data-bs-dismiss="modal">
            <i class="fas fa-trash text-white fs-5 "></i> &nbsp;Delete
          </button>&nbsp;
          <button class="btn-primary btn-sm text-white me-2" data-bs-dismiss="modal">
            <i class="fas fa-close text-white"></i> &nbsp;Close
          </button>
        
        </div>
      </div>
    </div>
  </div>
</div>
<form [formGroup]="reactiveFormFoldermove" #form="ngForm">
  <div class="modal" id="myModaladddetails" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Header -->

        <div class="card-header p-1 pb-2 pt-1 rounded-top bg-primary">
          <h2 style="margin-top:10px;color:white;font-weight: bold;">&nbsp;&nbsp;<i
              class="fa-solid fa-folder fs-3 me-5"></i> &nbsp;&nbsp;Move To Folder </h2>

        </div>
        <!-- Modal body -->
        <div class="modal-body">
          <div class="row">
            <span class="fw-bold required"
              [ngClass]="{'error_input_field': label_id.invalid && label_id.touched || label_id.errors?.['pattern'] }">Folder
              Name</span>
            <div class="col-lg-12 col-md-12 col-sm-12 fv-row mt-2 d-flex">

              <ng-select formControlName="label_id" [ngClass]="{'invalid-border': label_id.invalid && label_id.touched}"
                [items]="folders" class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="label_name"
                bindValue="label_id" placeholder="--Select Folder--"></ng-select>

            </div>
            <div *ngIf="label_id.invalid && (label_id.dirty || label_id.touched)">
              <div *ngIf="label_id.errors?.['required']">
                <span style="color:red;">Select Folder</span>
              </div>
            </div>
          </div>
          <!-- Modal footer -->
          <div class="text-center my-4">
            <button (click)="onmovefolder()" [disabled]="reactiveFormFoldermove.invalid"
              [ngStyle]="{ 'cursor': reactiveFormFoldermove.invalid ? 'not-allowed' : 'pointer'}" [ngClass]="{ 'btn-success': !reactiveFormFoldermove.invalid,
                  'btn-secondary text-white': reactiveFormFoldermove.invalid }" data-bs-dismiss="modal">
              <i class="fas fa-check text-white fs-5 "></i> &nbsp;Submit
            </button>
            &nbsp;&nbsp;
            <button class="btn-danger btn-sm text-white me-4" (click)="onclose()" data-bs-dismiss="modal">
              <i class="fas fa-close text-white"></i> &nbsp;Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>