<div class="card rounded-top">
  <!-- <div class="card card-body"> -->
  <div class="card-title p-5 pb-6 pt-6 rounded-top bg-primary">
    <h3 class="fw-bolder text-white"><i class="fa-solid fa-plus text-white fs-5"></i> Raise Sales Order
    </h3>
  </div>
  <input type="hidden" formControlName="tmpsalesorderdtl_gid">
  <!-- (ngSubmit)="onSubmit()" -->
  <form [formGroup]="combinedFormData">
    <div class="m-4 mt-4 border card">
      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Customer Ref. No</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
              placeholder="New Sales Order - Auto Generate" readonly style="height: 40px;" formControlName="so_referencenumber"
              class="form-control" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"> <span class="font-bold required">SO Date</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'red' : 'rgb(209, 209, 209)' , 'height': '42px'}"
              formControlName="salesorder_date" required
              class="form-control form-control-lg form-control-solid borderc-secondary date-picker custom-input mb-3 mb-lg-0 bg-white custom-input date-picker mt-2"
              placeholder="DD-MM-YYYY" />
          </div>
          <div *ngIf="salesorder_date.invalid && (salesorder_date.dirty || salesorder_date.touched)">
            <div *ngIf="salesorder_date.errors?.['required']">
              <span style="color:red;">Date is Required.</span>
            </div>
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold">Branch<span class="ms-1 text-red">*</span></span>
          <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <ng-select formControlName="branch_name" [(ngModel)]="mdlBranchName" [class.is-invalid]="
          branch_name.invalid && (branch_name.dirty || branch_name.touched)
            " [ngClass]="{'invalid-border': branch_name.invalid && branch_name.touched}" [items]="branch_list
            " required class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="branch_name"
              bindValue="branch_gid" placeholder="Select an option"></ng-select>
            <div *ngIf="
          branch_name.invalid && (branch_name.dirty || branch_name.touched)
            " class="invalid-feedback">
              <div *ngIf="branch_name.errors?.['required']">
                Branch is required.
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="d-flex flex-row m-6 flex-wrap">
       
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Customer</span>
          <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <ng-select formControlName="customer_name" [(ngModel)]="mdlCustomerName" [class.is-invalid]="
            customer_name.invalid && (customer_name.dirty || customer_name.touched)
              " [ngClass]="{'invalid-border': customer_name.invalid && customer_name.touched}" [items]="customer_list
              " required class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="customer_name"
               (change)="OnChangeCustomer()" (clear)="onClearCustomer()"
              placeholder="Select an option"></ng-select>
            <div *ngIf="
            customer_name.invalid && (customer_name.dirty || customer_name.touched)
              " class="invalid-feedback">
              <div *ngIf="customer_name.errors?.['required']">
                Customer is required.
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Contact Person</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
              readonly formControlName="customercontact_names" class="form-control bg-secondary" style="height:40px;"
              [(ngModel)]="txtcontactrperson" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold ">Contact Number</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
              readonly formControlName="customer_mobile" class="form-control bg-secondary" style="height:40px;"
              [(ngModel)]="txtcontactnumber" />
          </div>
        </div>

      </div>

      <div class="d-flex flex-row m-6 flex-wrap">
        
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold ">Email Address</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
              formControlName="customer_email" class="form-control bg-secondary" style="height:40px;"
              [(ngModel)]="txtemail" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Customer Address</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <textarea type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
              readonly formControlName="customer_address" class="form-control bg-secondary" [(ngModel)]="txtaddress"
              rows="3"></textarea>
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold required">Sales Person</span>
          <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <ng-select [items]="contact_list" class="custom col-lg-11 col-12 fv-row mt-2" [ngStyle]="{'border-color':
          user_name.invalid && user_name.touched? 'red': 'rgb(209, 209, 209)'
        }" bindLabel="user_name" formControlName="user_name" bindValue="user_gid" placeholder="Select an option"
              [(ngModel)]="mdlUserName" required> </ng-select>
            <div *ngIf="user_name.invalid && (user_name.dirty || user_name.touched)">
              <div *ngIf="user_name.errors?.['required']">
                <span style="color:red;">Select Sales Person.</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="d-flex flex-row m-6 flex-wrap">
       

        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Shipping Address</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <textarea type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
              placeholder="Shipping Address" formControlName="shipping_to" class="form-control" rows="3"></textarea>
          </div>
        </div>

        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Remarks</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <textarea type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
              placeholder="Enter The Remarks" formControlName="so_remarks" class="form-control" rows="3"></textarea>
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Expected Start Date</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" pattern="^(?!\s*$).+"
              [ngStyle]="{ 'border-color': combinedFormData.get('start_date')?.hasError('required') && combinedFormData.get('start_date')?.touched ? 'red' : 'rgb(209, 209, 209)' , 'height': '42px'}"
              class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white custom-input date-picker mt-2"
              placeholder="DD-MM-YYYY" formControlName="start_date" />
          </div>
        </div>
      </div>

      <div class="d-flex flex-row m-6 flex-wrap">

        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Esimated Time of Arraival</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" pattern="^(?!\s*$).+"
              [ngStyle]="{ 'border-color': combinedFormData.get('end_date')?.hasError('required') && combinedFormData.get('end_date')?.touched ? 'red' : 'rgb(209, 209, 209)' , 'height': '42px'}"
              class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white custom-input date-picker mt-2"
              placeholder="DD-MM-YYYY" formControlName="end_date" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Freight Terms</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
              placeholder="Freight terms" formControlName="freight_terms" class="form-control" style="height:40px;" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold required">Currency</span>
          <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">

            <ng-select formControlName="currency_code" [items]="currency_list" (change)="OnChangeCurrency()"
              (change)="onCurrencyCodeChange($event)" required
              class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="currency_code"
              bindValue="currencyexchange_gid" placeholder="Select an option" [(ngModel)]="mdlCurrencyName" required>
            </ng-select>
            <div *ngIf="currency_code.invalid && (currency_code.dirty || currency_code.touched)">
              <div *ngIf="currency_code.errors?.['required']">
                <span style="color:red;">Select Currency.</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex flex-row m-6 flex-wrap">

        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Exchange Rate</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" [(ngModel)]="exchange" (input)="prodtotalcal()"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
              readonly placeholder="Exchange Rate"  formControlName="exchange_rate" class="form-control bg-secondary"
              style="height:40px;" />
          </div>
        </div>
        <div class="col-12 col-lg-4 col-md-3 col-sm-12"><span class="font-bold">Payment Terms</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text"
              class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
              placeholder="Payment Terms" formControlName="payment_terms" class="form-control" style="height:40px;" />
          </div>
        </div>
      </div>
      <!-- end:: PO Add Form -->

      <!-- begin::Product Summary -->
      <div class="card-header bg-lightblue card-height55" style="border-radius: 0px;">
        <div class="card-title m-0">
          <h5 class="fw-bolder text-blue">Product Summary</h5>
        </div>
      </div>

      <form [formGroup]="productform" (ngSubmit)="productAdd()">
        <input type="hidden" formControlName="tmpsalesorderdtl_gid">
        <div class="d-flex flex-row flex-wrap m-6">
          <div class="col-12 col-lg-2 col-md-2 col-sm-12"><span class="font-bold required ">Product</span>
            <ng-select [items]="product_list" class="custom col-lg-11 col-12 fv-row mt-2" bindLabel="product_name"
              (change)="GetOnChangeProductsName()" (clear)="onClearProduct()" formControlName="product_name"
              placeholder="Select an option" [(ngModel)]="mdlproductName"></ng-select>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Product Code</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="text" class="form-control bg-secondary" [(ngModel)]="mdlProductCode"
                formControlName="product_code" readonly style="height:40px;">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Unit</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="text" class="form-control bg-secondary" style="height:40px; text-align: right;"
                [(ngModel)]="mdlProductUom" formControlName="productuom_name">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold required">Unit Price</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="number" class="form-control" placeholder="0.00" style="text-align: right;"
                [(ngModel)]="mdlunitprice" formControlName="unitprice" style="height:40px;" [(ngModel)]="unitprice"
                (input)="prodtotalcal()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Quantity</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="number" class="form-control" style="text-align: right;" formControlName="quantity"
                style="height:40px; text-align: right;" [(ngModel)]="quantity" (input)="prodtotalcal()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Discount(%)</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="number" class="form-control mt-2" placeholder="0.00" style=" text-align: right;"
                style="height:40px; text-align: right;" formControlName="discount_percentage" [(ngModel)]="discountpercentage"
                (input)="prodtotalcal()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Amount</span>
            <div class="col-lg-9 col-12 col-md-11 col-sm-11 fv-row mt-2 ms-1">
              <input type="number" class="form-control bg-secondary" placeholder="0.00" style=" text-align: right;"
                readonly style="height:40px;" formControlName="discountamount" [(ngModel)]="discountamount"
                (input)="prodtotalcal()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Tax</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <!-- <ng-select [items]="tax_list" bindLabel="tax_name" formControlName="tax_name" bindValue="tax_gid" placeholder="Select Tax" (change)="taxAmount()"></ng-select> -->
              <ng-select [items]="tax_list" class="
                          custom
                  col-lg-10 col-12
                  fv-row
                  mt-2
                " bindLabel="tax_name" formControlName="tax_name" bindValue="tax_name" (change)="OnChangeTaxAmount1()"
                (clear)="OnClearTax()" placeholder="Select Tax" [(ngModel)]="mdlTaxName1"></ng-select>
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Tax Amount</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="text" class="form-control bg-secondary" placeholder="0.00" readonly
                style="text-align: right; height:40px;" formControlName="tax_amount" [(ngModel)]="tax_amount"
                (input)="OnChangeTaxAmount1()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold">Total Amount</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="text" class="form-control bg-secondary" placeholder="0.00"
                style=" text-align: right; height:40px;" formControlName="totalamount" [(ngModel)]="totalamount"
                (input)="prodtotalcal()">
            </div>
          </div>

          <div class="col-12 col-lg-1 col-md-1 col-sm-12"><span class="font-bold text-center ms-5">Action</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <button title="Add" type="button" class="btn btn-icon btn-sm bg-success me-1" *ngIf="showAddButton" (click)="productAdd()">
                <span Class="fa-solid fa-plus text-white  fs-6"></span></button>
              <button title="Update" type="button" (click)="onupdate()" *ngIf="showUpdateButton"
                class="btn btn-icon btn-sm bg-primary me-1"><span
                  class="fa-solid fa-arrow-up text-white  fs-6"></span></button>
            </div>
          </div>
        </div>

        <!-- end::Product Form -->
        <!-- begin::table -->
        <div class="table-responsive">
          <div class="card card-body table-responsive m-0  p-3 mb-5 bg-white  rounded">
            <table id="salesorders_list" class="table table-striped table-row-bordered gy-4 gs-2">
              <thead class="table_head">
                <tr class="text-white fw-bold fs-5 text-nowrap bg-lightblue text-blue">
                  <th>S.No</th>
                  <th>Product </th>
                  <!-- <th>Product Group</th>             -->
                  <th>Product Code</th>
                  <!-- <th>HSN Code / Description</th> -->
                  <th>Unit</th>
                  <th>Unit Price</th>
                  <th>Check Price</th>
                  <th>Quantity</th>
                  <th>Discount (%)</th>
                  <th>Tax</th>
                  <th>Total Amount</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of salesorders_list; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.product_name}}</td>
                  <!-- <td>{{data.productgroup_name}}</td>             -->
                  <td>{{data.product_code}}</td>
                  <td>{{data.productuom_name}}</td>
                  <td>{{data.product_price}}</td>
                  <td>
                    <button title="Check Price" type="button" data-bs-toggle="modal" data-bs-target="#myModaldetailQO"
                      class="btn btn-icon btn-sm bg-success me-2 text-center"
                      (click)="openModelDetail(data.product_gid)"><span
                        class="fa-solid fa-question text-white  fs-6"></span></button>
                  </td>
                  <td>{{data.quantity}}</td>
                  <td>
                    <div class="container">
                      <div class="row">
                        {{data.discountpercentage}}&nbsp;
                      </div>
                      <div class="row">
                        {{data.discountamount}}
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="container">
                      <div class="row">
                        {{data.tax_name}}&nbsp;
                      </div>
                      <div class="row">
                        {{data.tax_amount}}
                      </div>
                    </div>
                  </td>
                  <td>
                    {{data.totalamount}}
                  </td>


                  <td class="text-center text-nowrap">
                    <button title="Edit" type="button" class="btn btn-icon btn-sm bg-etdark me-2"
                      (click)="editproductSO(data.tmpsalesorderdtl_gid)"><span
                        class="fa-solid fa-pencil text-white  fs-6"></span></button>
                    <button title="Delete" type="button" data-bs-toggle="modal" data-bs-target="#myModaldeleteSO"
                      class="btn btn-icon btn-sm bg-danger me-2"
                      (click)="openModaldelete(data.tmpsalesorderdtl_gid)"><span
                        class="fa-solid fa-trash text-white  fs-6"></span></button>


                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </form>

      <div class="card">
        <div class="row">
          <div class="col-9">
            <div class="card-header bg-lightblue card-height55 mt-5">
              <div class="card-title m-0">
                <h5 class="fw-bolder text-blue">Terms and Conditions</h5>
              </div>
            </div>
            <ng-select [items]="terms_list" class="custom col-lg-4 m-12 col-12 fv-row mt-5" bindLabel="template_name"
              [(ngModel)]="mdlTerms" formControlName="template_name" bindValue="template_gid"
              placeholder="Select an option" (change)="GetOnChangeTerms()"></ng-select>
  
  
            <div class="d-flex flex-row m-2 col-lg-12 table-responsive">
              <div class="col-12 col-lg-12 col-md-10  col-sm-10 fv-row">
                <angular-editor [config]="config" formControlName="termsandconditions"></angular-editor>
              </div>
            </div>
  
          </div>
          <div class="col-md-3">
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Payment Days:</label>
                <input type="number"
                  class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
                  formControlName="payment_days" placeholder="Payment Days" required style="width: 105px;height:40px;" />
              </div>
            </div>
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Delivery Days:</label>
                <input type="number" placeholder="Delivery Days"
                  class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0  borderc-secondary bg-white custom-input"
                  formControlName="delivery_days" class="form-control" required style="width: 105px; height:40px;" />
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Total :</label>
                  <input type="number" formControlName="totalamount" class="form-control  bg-secondary"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="producttotalamount"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Tax:</label>
                <ng-select class=" custom
                  col-lg-10 col-12
                  fv-row
                  mt-2" style="width:100px" [items]="tax4_list" formControlName="tax_name4" bindLabel="tax_name4"
                  bindValue="tax_gid" placeholder="Select Tax" [(ngModel)]="mdlTaxName4" (clear)="OnClearOverallTax()"
                  (change)="OnChangeTaxAmount4()" style=" width:100px; height: 40px;">
                </ng-select>
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Overall Tax:</label>
                <input type="text" class="form-control bg-secondary" (input)="OnChangeTaxAmount4()" readonly
                  style=" width:100px;text-align: right;" formControlName="tax_amount4" [(ngModel)]="tax_amount4">
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Total With Tax:</label>
                  <input type="text" formControlName="total_amount" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="total_amount"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
  
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Addon Charges:</label>
                <input type="text" formControlName="addon_charge" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="addon_charge"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Additional Discount:</label>
                <input type="text" formControlName="additional_discount" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="additional_discount"
                  (ngModelChange)="finaltotal()">
  
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Freight Charges:</label>
                <input type="text" formControlName="freight_charges" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="freight_charges"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Buy Back/Scrap:</label>
                <input type="text" formControlName="buyback_charges" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="buyback_charges"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Packing/Forwarding Charges:</label>
                <input type="text" class="form-control" style="width:100px; text-align: right;"
                  formControlName="packing_charges" [(ngModel)]="packing_charges" (ngModelChange)="finaltotal()"
                  placeholder="0.00">&nbsp;
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Insurance Charges:</label>
                <input type="text" formControlName="insurance_charges" class="form-control"
                  style="width:100px; text-align: right;" placeholder="0.00" [(ngModel)]="insurance_charges"
                  (ngModelChange)="finaltotal()">
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Round Off:</label>
                <input type="text" formControlName="roundoff" class="form-control" style="width:100px; text-align: right;"
                  placeholder="0.00" [(ngModel)]="roundoff" (ngModelChange)="finaltotal()">
              </div>
            </div>
  
            <div class="d-flex row justify-content-end mt-2">
              <div class="col-md-12 d-flex align-items-center">
                <label class="col-sm-6 col-form-label fw-bolder">Grand Total:</label>
                <input type="text" formControlName="grandtotal" readonly class="form-control bg-secondary"
                  style="width:100px;text-align: right;" placeholder="0.00" [(ngModel)]="grandtotal"
                  [ngModel]="grandtotal | number: '1.2-2'" (ngModelChange)="finaltotal()">
              </div>
            </div>
            <!--Summary count ends-->
          </div>
          <div class="text-center my-4">
              <button type="submit" class="btn-success btn-sm text-white me-4"
        [disabled]="combinedFormData.invalid" 
              [ngClass]="{'primary-button': !combinedFormData.invalid,'secondary-button': combinedFormData.invalid}"
        (click)="onSubmit()">
          <i class="fas fa-check text-white fs-5  "></i> &nbsp;Submit
        </button> &nbsp;&nbsp;
        <button class="btn-primary btn-sm text-white me-4" (click)="onback()">
          <i class="fas fa-arrow-left text-white"></i> &nbsp;Back
        </button>
          </div>
        </div>
      </div>
    </div>
  </form>
  <div class="modal" id="myModaldeleteSO" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog del_modal-dialog">
      <div class="modal-content del_modal-content">
        <div class="text-center my-4">
          <h2><b>Are you sure?</b></h2>
          <p style="display: block;">Do You Want To Delete the Record ?</p>
          <div class="text-center my-4">
            <button class="btn-danger btn-sm text-white me-4" data-bs-dismiss="modal" (click)="ondelete()">
              <i class="bi bi-trash-fill text-white fs-5 me-2"></i>Delete
            </button>
            <button class="btn-primary btn-sm text-white me-2" data-bs-dismiss="modal">
              <i class="fas fa-close text-white me-2"></i>Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>