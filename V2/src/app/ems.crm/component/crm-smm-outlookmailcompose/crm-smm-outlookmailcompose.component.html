<div class="card">
    <div class="card-header d-flex align-items-center bg-primary text-white justify-content-between">
        <div>
            <h2 style="margin-top: 15px; font-weight: bold;" class="text-white">
                &nbsp;&nbsp;<i class="fa fa-plus-circle fw-bolder fs-1"></i> &nbsp;&nbsp;Compose Mail
            </h2>
        </div>
        <div class="d-flex align-items-center">
            <i class="fas fa-undo fs-1 ms-6 mt-4 circular-icon text-black" (click)="summaryreset()" title="Reset" style="cursor: pointer;"></i>
            <i class="fas fa-arrow-left fs-1 ms-6 mt-4 circular-icon text-black" title="Back" (click)="onback()" style="cursor: pointer;"></i>
        </div>
    </div>
    

    <div class="card-body" style="overflow: auto;height: 500px;">

        <div class="">
            <div class="card-body p-0">
<form [formGroup]="outlookreactiveForm" #form="ngForm" id="kt_inbox_compose_form">
<div class="d-block">
    <div
        class="d-flex align-items-center border-bottom px-8 min-h-50px">

        <div class="text-gray-900 fw-bold w-75px">
            From:
        </div>
        <input [readonly]="isReadOnly" type="text" class="
        form-control form-control-lg form-control-solid
        bg-white
        custom-input
        mb-3 mb-lg-0
        borderc-secondary "
            formControlName="from_mail" />
    </div>
    <ng-container *ngIf="mailidfrom360 ===null">
    <div
        class="d-flex align-items-center border-bottom px-8 min-h-50px">
        <div class="text-gray-900 fw-bold w-75px">
            To:
        </div>
        <span *ngFor="let contact of selectedContacts; let i = index" class="badge badges">
            {{ contact.name }}&nbsp;&nbsp; <i title="Cancel" class="fa-solid fa-xmark fs-3" style="color: rgb(224, 37, 37);cursor: pointer;" (click)="removeContact(i)"></i>
        </span>&nbsp;
        <input #toInput type="text" class="
        form-control form-control-lg form-control-solid
        bg-white
        custom-input
        mb-3 mb-lg-0
        borderc-secondary " formControlName="to_mail" 
            data-kt-inbox-form="tagify" [(ngModel)]="toField" (input)="onSearch(toField)"/>&nbsp;
            <div class="flex-grow-1"></div>
            <div class="text-gray-900 fw-bold">
                <button title="Cc" type="button" (click)="toggleCcField()" class="bcc-button me-2">Cc</button>
            </div>
            <div class="text-gray-900 fw-bold">
                <button title="Bcc" type="button" (click)="toggleBccField()" class="bcc-button">Bcc</button>
            </div>
    </div>
    <div class="suggested-contacts" *ngIf="suggestedContacts.length > 0" style="overflow: auto;height: 200px;">
        <span class="fw-bold text-blue fs-3 ms-4">Suggested Contacts</span>
        <div class="contact" *ngFor="let contact of suggestedContacts"
            (click)="selectContact(contact, toInput)">
            <!-- <img [src]="contact.image" alt="{{ contact.name }}" class="contact-image" /> -->
            <div class="contact-info">
                <div class="contact-name">{{ contact.name }}</div>
                <div class="contact-email">{{ contact.email }}</div>
            </div>
        </div>
    </div>
    <div class="d-flex align-items-center border-bottom px-8 min-h-50px" *ngIf="showCcField">
        <div class="text-gray-900 fw-bold w-75px">
            Cc:
        </div>
        <span *ngFor="let contacts of selectedContacts_cc; let i = index" class="badge badges">
            {{ contacts.name }}&nbsp;&nbsp; <i title="Cancel" class="fa-solid fa-xmark fs-3" style="color: rgb(224, 37, 37);cursor: pointer;" (click)="removeContact_cc(i)"></i>
        </span>&nbsp;
        <input type="text" class="
                                form-control form-control-lg form-control-solid
                                bg-white
                                custom-input
                                mb-3 mb-lg-0
                                borderc-secondary " formControlName="cc_mail"
            data-kt-inbox-form="tagify" [(ngModel)]="toField_cc" (input)="onSearch_cc(toField_cc)"/>
           
    </div>
    <div class="suggested-contacts" *ngIf="suggestedccContacts.length > 0" style="overflow: auto;height: 200px;">
        <span class="fw-bold text-blue fs-3 ms-3">Suggested Contacts</span>
        <div class="contact" *ngFor="let contact of suggestedccContacts"
            (click)="selectccContact(contact, toInput)">
            <!-- <img [src]="contact.image" alt="{{ contact.name }}" class="contact-image" /> -->
            <div class="contact-info">
                <div class="contact-name">{{ contact.name }}</div>
                <div class="contact-email">{{ contact.email }}</div>
            </div>
        </div>
    </div>
    <div class="d-flex align-items-center border-bottom px-8 min-h-50px" *ngIf="showBccField">
        <div class="text-gray-900 fw-bold w-75px">
            Bcc:
        </div>
        <span *ngFor="let contacts of selectedContacts_bcc; let i = index" class="badge badges">
            {{ contacts.name }}&nbsp;&nbsp; <i title="Cancel" class="fa-solid fa-xmark fs-3" style="color: rgb(224, 37, 37);cursor: pointer;" (click)="removeContact_bcc(i)"></i>
        </span>&nbsp;
        <input type="text" class="
                                    form-control form-control-lg form-control-solid
                                    bg-white
                                    custom-input
                                    mb-3 mb-lg-0
                                    borderc-secondary me-3 " formControlName="bcc_mail" 
                                    [(ngModel)]="toField_bcc" (input)="onSearch_bcc(toField_bcc)"/>
    </div>
    <div class="suggested-contacts" *ngIf="suggested_bcc_Contacts.length > 0" style="overflow: auto;height: 200px;">
        <span class="fw-bold text-blue fs-3 ms-3">Suggested Contacts</span>
        <div class="contact" *ngFor="let contact of suggested_bcc_Contacts"
            (click)="select_bcc_Contact(contact, toInput)">
            <!-- <img [src]="contact.image" alt="{{ contact.name }}" class="contact-image" /> -->
            <div class="contact-info">
                <div class="contact-name">{{ contact.name }}</div>
                <div class="contact-email">{{ contact.email }}</div>
            </div>
        </div>
    </div>
    </ng-container>
    <ng-container *ngIf="mailidfrom360 !==null">
    <div
    class="d-flex align-items-center border-bottom px-8 min-h-50px">
   
    <div class="text-gray-900 fw-bold w-75px">
        To:
    </div>
    <input class="
form-control form-control-lg form-control-solid
bg-white
custom-input
mb-3 mb-lg-0
borderc-secondary " formControlName="to_mail" />
</div>
</ng-container>
    <div
        class="d-flex align-items-center border-bottom px-8 min-h-50px">
        <div class="text-gray-900 fw-bold w-75px">
            Subject:<span class="ms-1 text-red">*</span>
        </div>
        <input class="
form-control form-control-lg form-control-solid
bg-white
custom-input
mb-3 mb-lg-0
borderc-secondary " formControlName="mail_sub" />
    </div>
    <!-- <div *ngIf="gmail_sub.invalid && (gmail_sub.dirty || gmail_sub.touched)">
        <div *ngIf="gmail_sub.errors?.['required']">
            <span style="color:red;">&nbsp;Subject Is
                required.</span>
        </div>
    </div><br> --><br>
    <div class="d-flex flex-row m-6 mt-0">
        <div class="col">
            <span class="font-bold">Upload </span>
            <div class="col-lg-12 fv-row mt-2">
                <input (change)="ongamilChange1($event)" accept="image/*,.pdf,.doc,.docx,.txt,.xlsx,.xls,.mp4"
                    type="file" #fileInput class="
                form-control form-control-lg form-control-solid bg-white
                mb-3 mb-lg-0  borderc-secondary custom-input
                " name="fName"  formControlName="file"  multiple/>
            </div>
        </div>
    </div>
    <!-- <div class="col-12 col-lg-12 col-sm-12">
        <div class="d-flex flex-row m-6 mt-0 ">
            <div class="col">
                <div class="fv-row mt-2">
                    <div class="text-gray-900 fw-bold w-75px">
                        Body:<span class="ms-1 text-red">*</span>
                    </div>
                    <angular-editor [config]="config_compose_mail"
                        formControlName="mail_body">
                    </angular-editor>
                </div>
            </div>
        </div>
    </div> -->
    <div class="col-12 col-lg-12 col-sm-12">
        <div class="d-flex flex-column m-6 mt-0">
          <div class="col">
            <div class="fv-row mt-2">
              <div class="d-flex justify-content-between align-items-center">
                <div class="text-gray-900 fw-bold w-75px ms-3">
                  Body:<span class="ms-1 text-red">*</span>
                </div>
                <a class="button-link me-3" data-bs-toggle="modal" data-bs-target="#myModaladd" style="cursor: pointer;">
                  <b>Share Cloud Document</b>
                </a>
              </div>
              <angular-editor [config]="config_compose_mail" formControlName="mail_body"></angular-editor>
            </div>
          </div>
        </div>
      </div>

</div>
<div
    class="d-flex flex-stack flex-wrap justify-content-center gap-2 py-5 ps-8 pe-5 border-top">
    <div class="d-flex align-items-center me-3">
        <div class="btn-group align-items-center  me-4 ">
            <div class="btn-group">
                <button title="Send" type="button" class="btn-primary btn-sm text-white me-4 mt-2 ms-10"
                [ngClass]="{
'primary-button': !outlookreactiveForm.invalid,
'secondary-button': outlookreactiveForm.invalid
}" (click)="onaddmail()" data-bs-dismiss="modal"> <i class="fas fa-paper-plane text-white"></i>
                &nbsp;Send</button>
                <!-- <button type="button" [disabled]="outlookreactiveForm.invalid"
                    class="btn-success btn-sm text-white me-4"
                    [ngClass]="{
                'primary-button': !outlookreactiveForm.invalid,
                'secondary-button': outlookreactiveForm.invalid
              }"    (click)="onaddmail()" data-bs-dismiss="modal" > <i class="fas fa-paper-plane text-white"></i>
                    &nbsp;Send</button> -->
            </div>
        </div>
    </div>
</div>
</form>
</div>
</div>
</div>
<div class="modal modal-lg" id="myModaladd" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->

            <div class="card-header p-1 pb-2 pt-1 rounded-top bg-primary">
                <h2 style="margin-top:10px;color:white;font-weight: bold;">&nbsp;&nbsp;<i
                        class="fa-solid fa-upload fs-3"></i> &nbsp;&nbsp;Share Cloud Document</h2>

            </div>

            <div class="card p-3 m-2">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item" *ngFor="let crumb of breadcrumbs; let last = last">
                            <a *ngIf="!last" (click)="navigateToFolder(crumb)"  [ngStyle]="{'cursor': 'pointer'}">{{ crumb.name }}</a>
                            <span *ngIf="last">{{ crumb.name }}</span>
                        </li>
                    </ol>
                </nav>
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <div class="table-responsive">
                    <div class="mx-3 p-3 pt-0 pb-0 bg-white rounded" style="height: 250px;overflow-y: auto;">
                        <table id="folder_lists" style="height: 100px; overflow-y: auto;"
                            class="table table-striped table-row-bordered border-bottom gs-7 align-middle">
                            <thead>
                                <tr class="fw-bolder fs-5 text-nowrap bg-lightblue text-blue align-middle">
                                    <th>
                                        <!-- <input type="checkbox" id="checkAll" (change)="$event ? masterToggle() : null"
                            [checked]="selection.hasValue() && isAllSelected()"
                            [indeterminate]="selection.hasValue() && !isAllSelected()" />
                        All -->
                                    </th>
                                    <th>Type<i class="fa ms-2"></i></th>
                                    <th>Name<i class="fa ms-2"></i></th>
                                    <th>Created On<i class="fa ms-2"></i></th>
                                    <th>Created By<i class="fa ms-2"></i></th>
                                    <!-- <th class="text-center">Action
                                    <button title="Download All" style="color: #009EF7; background: transparent; border:none"
                                    (click)="DownloadUploadDocAllFiles(folder_list)">
                                    <em class="fa fa-download" style="color: #0e0f10;"></em>
                                  </button>
                                </th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let data of folder_list; let i=index;">
                                    <td *ngIf="data.docupload_type === 'File'"> <input type="checkbox" (click)="$event.stopPropagation()"
                                            (change)="$event ? selection.toggle(data) : null"
                                            [checked]="selection.isSelected(data)" /></td>
                                            <td  *ngIf="data.docupload_type === 'Folder'"></td>
                                    <td *ngIf="data.docupload_type === 'File'">
                                        <i style="font-size: 25px;"
                                            [class]="getIconClass(data.fileupload_name)"></i>
                                    </td>
                                    <td *ngIf="data.docupload_type === 'Folder'">
                                        <i class="fa fa-folder" style="color: #FFD700; font-size: 25px;"></i>
                                    </td>

                                    <td *ngIf="data.docupload_type == 'File'" style="color: blue;">
                                        {{data.fileupload_name}}
                                    </td>
                                    <td *ngIf="data.docupload_type == 'Folder'"
                                        style="color: blue;cursor: pointer;" (click)="openFile(data.docupload_gid, data.docupload_name)">
                                        {{data.docupload_name}}
                                    </td>
                                    <td>{{data.created_date}}</td>
                                    <td>{{data.created_by}}</td>
                                    <!-- <td class="text-center text-nowrap" >
                                    <button title="Edit" type="button" class="btn btn-icon btn-sm bg-etdark me-2" (click)="editinfo(data.docupload_gid,data.docupload_name,data.docupload_type,data.fileupload_name)"  data-bs-target="#editnewfolder" data-bs-toggle="modal"><span class="fa-solid fa-pencil text-white  fs-6"></span></button>
                                    <button title="Download" (click)="download(data.file_path,data.fileupload_name)" *ngIf="data.docupload_type == 'File'" type="button"
                                    class="btn btn-icon btn-sm bg-primary me-2 fs-3"><span class="fa-solid fa-download text-white fs-6"></span></button>
                                    <button title="Delete" type="button" class="btn btn-icon btn-sm bg-danger me-2"  data-bs-target="#Deferraldelete"
                                    data-bs-toggle="modal" (click)="delete(data.docupload_gid, data.docupload_type)"><span class="fa-solid fa-trash text-white fs-6"></span></button> 
                                </td> -->
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <br>

                <!-- Modal footer -->
                <div class="text-center my-4">
                    <button type="submit" class="btn-success btn-sm text-white me-2" (click)="sharedocument()"  data-bs-dismiss="modal">
                        <i class="fa-solid fa-share-nodes fs-3 me-2"></i>Share
                    </button> &nbsp;&nbsp;
                    <button class="btn-danger btn-sm text-white me-4" (click)="onclosepop()"
                        data-bs-dismiss="modal">
                        <i class="fas fa-close text-white"></i> &nbsp;Close
                    </button>

                </div>
            </div>
        </div>
    </div>
</div>
</div>