<div class="card m-5">
    <form [formGroup]="InvoiceForm">
  <div class="card-title p-5 pb-3 pt-3 rounded-top bg-primary d-flex justify-content-between align-items-center">
      <h1 class="fw-bolder text-white"><i class="fa f fs-2" aria-hidden="true"></i>&nbsp;&nbsp;Service Invoice Confirm</h1>
      <button style="color: black !important;" class="btn btn-icon btn-sm bg-secondary cursor-pointer " title="back"
          routerLink="/payable/PmrTrnInvoiceAddselect"><i class="fa-solid fa-arrow-left-long fs-1 fw-bold"></i></button>
    </div>
    <!-- -------------- first Tab ------------- -->
     <div class="card mt-1 m-3 mb-0">
      <div class="card-header d-flex align-items-center mb-3 cursor-pointer no-arrow" style="background-color: #def0ff;">
        <div>
          <p class="card-title fw-bold fs-3 no-arrow" style="color: #2599ff;">
            <i class="fa-solid fa-clipboard fs-1"></i> &nbsp;&nbsp;Invoice Details
          </p>
        </div>
      </div>
      <div >
          
              <div  class="d-flex flex-row m-2 flex-wrap">
                  <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold">Branch</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="branch_name"  (change)="OnChangeBranch()" (clear)="onclearBranch()"
            class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
            placeholder="Branch" style="height:40px;" readonly />
          </div>
        </div>             
                    <!-- --------------PR Ref. No ------------- -->
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold" >Invoice Ref. No</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" formControlName="invoice_ref_no"  
            class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
              placeholder="Invoice Ref. No" style="height:40px;" />
          </div>
        </div>
                              <!-- -------------- PO Date ------------- -->
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold" >Invoice Date<span class="ms-1 text-red">*</span></span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="date"   pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': InvoiceForm.get('invoice_date')?.hasError('required')
               && InvoiceForm.get('invoice_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
              formControlName="invoice_date"
             class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
            custom-input date-picker "  placeholder="DD-MM-YYYY" style="height: 40px;"/>
          </div>
       </div>         
      </div>
             <!-- -------------- Vendor Name ------------- -->
      <div class="d-flex flex-row m-2 flex-wrap">
          <div class="col-12 col-lg-4 col-md-6 col-sm-12">
            <span class="font-bold">Vendor Name</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">  
              <input type="text" formControlName="vendor_companyname"  
              class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
            placeholder="Vendor Name" style="height:40px;" readonly />
            </div>
            <div class="col-11  fv-row mt-4 ">
                <textarea type="text"
                class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
                placeholder="Vendor Details" formControlName="vendor_details" class="form-control" readonly
                rows="4"></textarea>
            </div>
          </div>
           <!-- -------------- bill To ------------- -->
          <div class="col-12 col-lg-4 col-md-3 col-sm-12">
            <span class="font-bold">Bill To</span>
            <div class="col-11 fv-row mt-4">
              <textarea type="text"
                class="form-control mt-4 form-control-lg form-control-solid bg-secondary custom-input mb-1 mb-lg-2 border-secondary bg-white custom-input"
                placeholder="Bill To"   formControlName="address1" class="form-control" rows="6" readonly></textarea>
            </div>
          </div>
          <!-- -------------- Shipment To ------------- -->
          <div class="col-12 col-lg-4 col-md-3 col-sm-12">
            <span class="font-bold">Ship To</span>
            <div class="col-11 fv-row mt-4">
              <textarea type="text"
                class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
                placeholder="Ship To" formControlName="shipping_address" class="form-control" 
                rows="6"></textarea>
            </div>
          </div>       
        </div>                   
        <div class="d-flex flex-row m-2 flex-wrap">
          <!-- currency_code -->
          <div class="col-10 col-lg-4 col-md-12 col-sm-12">
              <span class="font-bold">Currency</span>
              <div class="d-flex align-items-center">
                <input type="text" formControlName="currency_code"  
                class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
                placeholder="Currency" style="height:40px;width: 43%;margin-right: 20px;" readonly />
                <input type="text"  readonly
                class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white bg-secondary custom-input"
                  formControlName="exchange_rate"
                  style="width: 43%; height: 40px;" />
              </div>
          </div>
<!-- -------------- Delivery To ------------- -->
   <div class="col-12 col-lg-4 col-md-6 col-sm-12">
     <span class="font-bold">Delivery Terms</span>
     <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
    <input type="text"   formControlName="delivery_terms" 
    class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
      placeholder="Delivery" style="height:40px;" readonly />
   </div>
    </div>
   <!-- -------------- Payment To ------------- -->
   <div class="col-12 col-lg-4 col-md-6 col-sm-12">
    <span class="font-bold">Payment Terms</span>
    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
    <input type="text" formControlName="payment_terms" 
    class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
      placeholder="Payment" style="height:40px;" readonly />
   </div>
    </div>
   </div>         
   <!-- Mode of Dispatch -->
      <div class="d-flex flex-row m-2 flex-wrap">
          <div class="col-12 col-lg-4 col-md-6 col-sm-12">
            <span class="font-bold">Mode of Dispatch</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="text"  formControlName="dispatch_mode" 
              class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
                placeholder="Mode of Dispatch" style="height:40px;" readonly />
            </div>
          </div>
           <!-- -------------- Due Date ------------- -->
            <div class="row col-4">
           <div class="col-12 col-lg-6 col-md-6 col-sm-12">
            <span class="font-bold">Due Date</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
              <input type="date"   pattern="^(?!\s*$).+" [ngStyle]="{ 'border-color': InvoiceForm.get('due_date')?.hasError('required')
               && InvoiceForm.get('due_date')?.touched ? 'red' : 'rgb(209, 209, 209)'}"
              formControlName="due_date"
             class="form-control form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white
            custom-input date-picker "  placeholder="DD-MM-YYYY" style="height: 40px;"/>
          </div>
          </div>
          <div class="col-lg-6 col-12 ">
            <span class="font-bold"
                [ngClass]="{'error_input_field': purchase_type.invalid && purchase_type.touched}">Purchase
                Type<span class="ms-1 text-red">*</span></span>
            <div class="d-flex align-items-center ">
                <ng-select [items]="purchasetype_list" style="margin-right: 10px;"
                    class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" [ngClass]="{
                'invalid-border':
                purchase_type.invalid && purchase_type.touched
              }" bindLabel="purchasetype_name" formControlName="purchasetype_name" bindValue="purchasetype_gid"
                    placeholder="Select an option" required>
                </ng-select>
            </div>
        </div>
        </div>
          <!-- -------------- Billing Email------------- -->
          <div class="col-12 col-lg-4 col-md-6 col-sm-12 ms-6">
              <span class="font-bold">Billing Email</span>
              <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <input type="text" formControlName="billing_mail" 
                class="form-control form-control-lg  custom-input mb-3 mb-lg-0 bg-white custom-input"
                  placeholder="Billing Email" style="height:40px;"/>
              </div>
            </div>
        </div>                   
                       <!-- -------------- PO Cover Note ------------- -->
      <div class="d-flex flex-row m-2 flex-wrap">
          <div class="col-12 col-lg-12 col-md-4 col-sm-11"><span class="font-bold">Remarks</span>
            <div class="col-lg-12 col-12 col-md-4 col-sm-11 fv-row mt-2">
              <textarea style="width: 98%;" type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="invoice_remarks"
                placeholder="Enter Remarks" class="form-control "  rows="3"></textarea>
            </div>
          </div>         
        </div>                                  
          <!-- </form> -->
      </div>
   <!-- --------------Second Tab ------------- -->
   </div>
   <div class="card mt-1 ms-4 me-4">
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="kt_tab_pane_2" role="tabpanel">
            <div>
                    <table class="table table-striped table-bordered text-blue border-bottom gs-7 align-middle">
                        <thead>
                            <tr class="fw-bold fs-6 text-nowrap bg-lightblue text-blue align-middle">
                                <th class="text-blue" style="width: 8%;">Product Group</th>
                                <th class="text-blue" style="width: 6%;">Product Code</th>
                                <th class="text-blue" style="width: 15%;">Product</th>
                                <th class="text-blue" style="width: 15%;">Description</th>
                                <th class="text-blue" style="width: 3%;">Quantity</th>
                                <th class="text-blue" style="width: 1%;">Price</th>
                                <th class="text-blue" style="width: 6%;" colspan="2">Discount</th>
                                <th class="text-blue" style="text-align:center;width: 5%;">Tax</th>
                                <th class="text-blue" style="text-align:center;width: 4%;">Tax Rate</th>
                                <th class="text-blue" style="width: 1%;">Total Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of purchaseorderproduct_list; let i=index;">
                                <td style="width: 6%;">{{data.productgroup_name}}</td>
                                <td style="width: 6%;">{{data.product_code}}</td>
                                <td style="text-align: left;">{{data.product_name}}</td>
                                <td>{{data.display_field_name}}</td>
                                <td style="text-align: right;">{{data.qyt_unit}}</td>
                                <td style="text-align: right;">{{data.product_price_L | number:'1.0-2'}}</td>
                                <td style="text-align: right;">{{data.discount_percentage }}%</td>
                                <td style="text-align: right;"> {{data.discount_amount1 | number:'1.0-2'}}</td>
                                <td class="text-center" >{{data.tax_name}}
                                <span *ngIf="data.tax_name2 !== ''"><br>{{ data.tax_name2 }}</span>
                                 </td>
                                 <td style="text-align: right;">
                                  {{data.tax_amount | number:'1.0-2'}}
                                  <span *ngIf="data.tax_amount2 !== '0'"><br>{{data.tax_amount2 | number:'1.0-2'}}</span>
                                </td>
                                <td style="text-align: right;">{{data.product_total | number:'1.0-2'}}</td>
                            </tr>
                        </tbody>
                    </table> 
            </div>
        </div>
    </div>
</div>
<div class="card mt-1 m-3 mb-0">    
    <!-- <form [formGroup]="InvoiceForm"> -->
      <div class="m-2 card">
        <div class="row">
          <div class="col-lg-8">
            <div class="mt-2 card border">
              <div class="d-flex justify-content-between align-items-center rounded-top"
                style="background-color: #def0ff;">
                <div class="">
                  <h3 class="fw-bolder ms-3 mt-2" style="color: #2599ff;">Terms and Conditions</h3>
                </div>
                <div class="col-4">
                  <ng-select [items]="terms_list" class="custom mt-2 me-2 mb-2" bindLabel="template_name"
                    [(ngModel)]="mdlTerms" formControlName="template_name" bindValue="template_gid"
                    placeholder="Select an option" (change)="GetOnChangeTerms()"></ng-select>
                </div>
              </div>
              <div class="m-3">
                <angular-editor [config]="config" formControlName="template_content"></angular-editor>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-4 col-md-4 col-sm-12">
            <div class="d-flex flex-row m-4 flex-wrap ">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold">Net Amount :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text"  class=" form-control-lg form-control fw-bold bg-secondary"  formControlName="netamount" [(ngModel)]="producttotalamount" (ngModelChange)="finaltotal()" style="text-align: right;" readonly>
                </div>
              </div>
            </div>
            <div class="d-flex flex-row m-4 flex-wrap" *ngIf="allchargeslist[0].flag == 'Y'">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold">Add On Charges :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text" class="form-control-lg form-control" formControlName="addoncharge" [(ngModel)]="addoncharge" (ngModelChange)="finaltotal()" style=" text-align: right;">
                </div>
              </div>
            </div>
          
            <div class="d-flex flex-row m-4 flex-wrap" *ngIf="allchargeslist[1].flag == 'Y'">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold text-nowrap">Additional Discount :</label>      
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text" class="form-control-lg form-control" formControlName="additional_discount" 
                  [(ngModel)]="additional_discount" (ngModelChange)="finaltotal()" 
                  style=" text-align: right;">
                </div>
              </div>
            </div>
            <div class="d-flex flex-row m-4 flex-wrap" *ngIf="allchargeslist[2].flag == 'Y'">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold text-nowrap">Freight Charges :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text" class="form-control-lg form-control" formControlName="freightcharges" 
                  [(ngModel)]="freightcharges" (ngModelChange)="finaltotal()" 
                  style=" text-align: right;">
                  <!-- <input type="text" class="form-control" placeholder="0.00"
                  formControlName="freightcharges" [(ngModel)]="frieghtcharges"  
                  (ngModelChange)="finaltotal()" style=" text-align: right;"> -->

                </div>
              </div>
            </div>
            <div class="d-flex flex-row m-4 flex-wrap">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-8 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold text-nowrap">Additional Tax :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                  <Div class="d-flex">
                        <ng-select  [items]="tax4_list" formControlName="tax_name4" bindLabel="tax_name4" 
                        bindValue="tax_gid" placeholder="Select Tax" [(ngModel)]="mdlTaxName4" (clear)="OnClearOverallTax()" (change)="OnChangeTaxAmount4()">
                      </ng-select>&nbsp;&nbsp;
                     
                  <input type="text" class="form-control-lg form-control bg-secondary"  (input)="OnChangeTaxAmount4()" readonly
                  style="text-align:right;" formControlName="tax_amount4"
                  [(ngModel)]="tax_amount4"> 
              </Div>
              </div>
            </div>
            <div class="d-flex flex-row m-4 flex-wrap">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold">Round Off :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text" class="form-control-lg form-control" formControlName="roundoff" [(ngModel)]="roundoff" (ngModelChange)="finaltotal()" style=" text-align: right;">
                </div>
              </div>
            </div>
          
            <div class="d-flex flex-row m-4 flex-wrap">
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row">
                  <label class="col-form-label font-bold">Grand Total :</label>
                </div>
              </div>
              <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row">
                  <input type="text" class="form-control-lg form-control fw-bold bg-secondary" formControlName="total_amount" [(ngModel)]="grandtotal" (ngModelChange)="finaltotal()" style=" text-align: right;" readonly>
                </div>
              </div>
            </div>    
          </div>
        </div>
        <div class="text-center my-4">
            <button type="submit" class="btn-success btn-sm text-white me-2" (click)="onSubmit()">
                <i class="fa fa-check fs-5 me-3"></i>Submit
            </button>
            <button *ngIf="showPriceChangeButton" type="submit" class="btn-success btn-sm text-white me-2" (click)="onpricechange()">
              <i class="fa fa-check fs-5 me-3"></i>Price Change Request
            </button>   
            <button class="btn-primary btn-sm text-white me-4" routerLink="/payable/PmrTrnInvoiceAddselect">
              <i class="fas fa-arrow-left me-2"></i>Cancel
          </button>         
         </div>
      </div>
  
</div>
</form>
</div>