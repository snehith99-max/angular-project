<div class="card rounded-top mt-4">
    <div class="card-title p-5 pb-3 pt-3 rounded-top bg-primary d-flex justify-content-between align-items-center">
        <h1 class="fw-bolder text-white"><i class="fa-solid fa-plus  fs-2" aria-hidden="true"></i>&nbsp;&nbsp;
            Raise Purchase Indent</h1>
        <button style="color: black !important;" class="btn btn-icon btn-sm bg-secondary cursor-pointer " title="back"
            routerLink="/ims/ImsTrnPendingMaterialIssue"><i class="fa-solid fa-arrow-left-long fs-1 fw-bold"></i></button>
    </div>
    <form [formGroup]="issuerequestform" #form="ngForm">
        <div class="card p-4 border ms-5 me-5 mb-4">
            <div class="d-flex flex-row m-2 flex-wrap mt-1">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                  <span class="font-bold">Branch</span>
                  <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="form-control form-control-lg form-control-solid 
                    mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="branch_name"
                     placeholder="Branch" style="height:40px;" />
                  </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                  <span class="font-bold">MI Ref No</span>
                  <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                    <input type="text" class="form-control form-control-lg form-control-solid
                              mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="materialrequisition_gid"
                      placeholder="MI Ref No" style="height:40px;" />
                  </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                    <div  class="d-flex flex-row  flex-wrap">
                  <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                    <span class="font-bold" >MI Date</span>
                    <div class="col-lg-1o col-12 col-md-10 col-sm-10 fv-row mt-2">
                        <input type="text" class="form-control form-control-lg form-control-solid
                        mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="materialrequisition_date"
                        placeholder="MI Date" style="height:40px;" />
                        
                </div>
                </div>
                <div class="col-12 col-lg-6 col-md-6 col-sm-12">
                    <span class="font-bold" >Expected Date <span class="ms-1 text-red">*</span></span>
                    <div class="col-lg-10 col-12 col-md-10 col-sm-10 fv-row mt-2">
                        <input type="date"   pattern="^(?!\s*$).+" 
                        formControlName="expected_date"
                        class="form-control form-control-lg form-control-solid
                        mb-3 mb-lg-0  borderc-secondary bg-white custom-input date-picker"   placeholder="DD-MM-YYYY" style="height: 40px;"/>
                </div>
                </div>
          </div>
          </div>
        </div>
        <div class="d-flex flex-row m-2 flex-wrap mt-1">
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
              <span class="font-bold">Department</span>
              <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <input type="text" class="form-control form-control-lg form-control-solid 
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="department_name"
                 placeholder="Department" style="height:40px;" />
              </div>
            </div>
            <div class="col-12 col-lg-4 col-md-6 col-sm-12">
              <span class="font-bold">Raised By</span>
              <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <input type="text" class="form-control form-control-lg form-control-solid
                          mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="user_firstname"
                  placeholder="Raised By" style="height:40px;" />
              </div>
            </div>
            <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12">
                <span class="font-bold">Priority</span>
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                  <input type="text" class="form-control form-control-lg form-control-solid
                            mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly formControlName="priority"
                    placeholder="Priority" style="height:40px;" />
                </div>
              </div> -->
              <div class="col-12 col-lg-3 col-md-6 col-sm-12 "><span class="font-bold">Priority</span>
     
     
                <div class="d-flex justify-content-start mt-4 ms-2">

                  <div class="form-check form-check-custom form-check-primary form-check-solid form-check-sm">
                    <input type="radio"  formControlName="priority"
                      name="priority" value="Low">


                    <label class="form-check-label text-gray-700 text-nowrap"
                      for="kt_builder_header_content_menu">Low</label>

                  </div>


                  <div class="form-check form-check-custom form-check-primary form-check-solid form-check-sm ms-10">
                    <input type="radio"  formControlName="priority"
                      name="priority" value="High">

                    <label class="form-check-label text-gray-700 text-nowrap"
                      for="kt_builder_header_content_page-title">High</label>

                  </div>



                </div>


              </div>
    </div>
    <div class="d-flex flex-row m-2 flex-wrap mt-1">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12">
          <span class="font-bold">MI Remarks</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <textarea type="text"
            class=" mt-4 form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
             placeholder="MI Remarks" formControlName="materialrequisition_remarks" class="form-control" readonly
            rows="4"></textarea>
          </div>
        </div>
        <div class="col-12 col-lg-8 col-md-6 col-sm-12 ">
          <span class="font-bold">Priority Remarks</span>
          <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2 pe-10">
            <textarea type="text"
            class="mt-4 form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 bg-secondary border-secondary custom-input"
             placeholder="Priority Remarks" formControlName="priority_remarks" class="form-control" 
            rows="4"></textarea>
          </div>
        </div>
        </div>
        <div *ngFor="let data of issueequest_list;">
        <div class="card mt-1 ms-4 me-4">
            <div class="tab-content" id="productrequestlist">
                <div class="tab-pane fade show active" id="kt_tab_pane_2" role="tabpanel">
                    <div>
                        <table class="table table-striped table-bordered text-blue border-bottom gs-7 align-middle">
                            <thead>
                                <tr class="fw-bold fs-6 text-nowrap bg-lightblue text-blue align-middle">
                                    <th class="text-blue text-center" style="width: 10%;">Product Group</th>
                                    <th class="text-blue text-center" style="width: 15%;">Product </th>
                                    <th class="text-blue text-center" style="width: 20%;">Description</th>
                                    <th class="text-blue text-center" style="width: 5%;">Request Qty</th>
                                    <th class="text-blue text-center" style="width: 5%;">Issued Qty</th>
                                    <th class="text-blue text-center" style="width: 5%;">Pending MI</th>
                                    <th class="text-blue text-center" style="width: 5%;">Pending PI</th>
                                    <th class="text-blue text-center" style="width: 5%;">Stock Qty</th>
                                    <!-- <th class="text-blue text-center" style="width: 5%;">Available Qty</th> -->
                                    <th class="text-blue text-center" style="width: 10%;">Raise PI</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let data of productrequestlist; let i=index;">
                                    <td>{{data.productgroup_name}}</td>
                                    <td>{{data.product_code}}/{{data.product_name}}</td>
                                    <td>{{data.display_field}}</td>
                                    <td>{{data.req_qty}}</td>
                                    <td>{{data.qty_issued}}</td>
                                    <td>{{data.pending_mr}}</td>
                                    <td>{{data.pending_pr}}</td>
                                    <td>{{data.stock_quantity}}</td>
                                    <!-- <td>{{data.net_avalible}}</td> -->
                                    <td class=" padding_custom" style="width: 1%;">
                                        <!-- <input type="number" formControlName="qty_requested_{{i}}"
                                            class="form-control form-control-lg form-control-solid custom-input custom_height borderc-secondary bg-white custom-input"
                                            placeholder="0.00" style="text-align: right;" value="qty_requested"
                                            [(ngModel)]="qty_req"> -->

                                            <input type="text" (ngModelChange)="qytrecived(i, data.req_qty, $event)"
                    class="form-control form-control-lg form-control-solid custom-input mb-3 mb-lg-0 borderc-secondary bg-white custom-input"
                    formControlName="qty_requested_{{i}}" [(ngModel)]="data.qty_req" style="text-align: right;" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div class="text-center my-4">
    <button (click)="submit(data.materialrequisition_gid)" [disabled]="issuerequestform.invalid"
        [ngStyle]="{ 'cursor': issuerequestform.invalid ? 'not-allowed' : 'pointer'}" [ngClass]="{ 'btn-success': !issuerequestform.invalid,
                        'btn-secondary text-white': issuerequestform.invalid }" data-bs-dismiss="modal">
        <i class="fas fa-check text-white fs-5 "></i> &nbsp;Submit
    </button>&nbsp;
    <button class="btn-primary btn-sm text-white me-4" routerLink="/ims/ImsTrnPendingMaterialIssue">
        <i class="fas fa-arrow-left"></i> &nbsp; Back
      </button>
</div>
</div>
</div>
</form>
</div>