<div class="card shadow p-3 mb-5 bg-white rounded">
    <div class="card-header justify-content-center cardhead ">
        <h3 class="card-title">Monthly Attendance Report</h3>
    </div>
    <br>
    <form [formGroup]="reactiveFormSubmit" #form="ngForm">
        <div class="d-flex flex-row fv-row flex-wrap">
            <div class="col-12 col-lg-3 col-md-3 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-5 ms-5"><span class="font-bold">Branch</span>
                    <ng-select
                    class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2"
                    [(ngModel)]="selectedBranch" formControlName="branch_name" placeholder="Select Branch">
                        <ng-option *ngFor="let branch of monthlyreportbranch" [value]="branch.branch_gid">
                            {{branch.branch_name}}
                        </ng-option>
                    </ng-select>
                </div>
            </div>
            <div class="col-12 col-lg-3 col-md-3 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-5 ms-5"><span class="font-bold">Month</span>
                    <ng-select
                    class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2"
                        formControlName="month">
                        <ng-option value="undefined" hidden disabled>Select Month</ng-option>
                        <ng-option *ngFor="let month of months" [value]="month.value">
                            {{month.name}}</ng-option>
                    </ng-select>
                </div>
            </div>
            <div class="col-12 col-lg-3 col-md-3 col-sm-12">
                <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-5 ms-5"><span class="font-bold">Year</span>
                    <input type="text"
                        class="form-control form-control-lg form-control-solid borderc-secondary date-picker mb-3 mb-lg-0 bg-white custom-input mt-2"
                        formControlName="year" />
               </div>
            </div>
            <div class="col-12 col-lg-2 col-md-2 col-sm-12 ">
                    <button type="button" title="Search" class="btn-primary btn-sm text-white me-4 mb-2 mt-13 float-end"
                    style="height: 25px; line-height: 20px; padding: 0 10px; display: flex; align-items: center;" (click)="GetMonthlyreport_summary()">
                    <i class="fas fa-search me-4"></i>Search
                    </button>
            </div>           
        </div>
    </form>   
    <!-- <div class="ptagcenter">
        <p style="color: red;" class="ptagcenter"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
            &nbsp; &nbsp; &nbsp;

            Note* &nbsp; &nbsp; &nbsp; &nbsp; XX-Present &nbsp; &nbsp; &nbsp;
            &nbsp;
            AA-Absent &nbsp; &nbsp; &nbsp; &nbsp;
            WH-Weekoff &nbsp; &nbsp; &nbsp; &nbsp;
            NH-Holiday &nbsp; &nbsp; &nbsp; &nbsp;
            OD-Onduty &nbsp; &nbsp; &nbsp; &nbsp;
            XL-Present with half-day Leave &nbsp; &nbsp; &nbsp; &nbsp;
            LX-Present with half-day Leave &nbsp; &nbsp; &nbsp; &nbsp;
            AL-Absent with half-day Leave &nbsp; &nbsp; &nbsp; &nbsp;
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        <p style="color: red;" class="ptagcenter"> LA-Absent with half-day Leave &nbsp; &nbsp; &nbsp; &nbsp;
            XA-Present with half-day Absent &nbsp; &nbsp; &nbsp; &nbsp;
            AX-Present with half-day Absent

        </p>
    </div> --->

    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; max-width: 1000px; margin: auto; padding: 10px;">
        <div style="display: flex; align-items: center;">
            <span style="background-color: #A9D979; color: white; padding: 5px 10px; border-radius: 4px;">XX</span>
            <span style="color: black; margin-left: 5px;">- Present</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #EB826C; color: white; padding: 5px 10px; border-radius: 4px;">AA</span>
            <span style="color: black; margin-left: 5px;">- Absent</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #F2F0CE; color: white; padding: 5px 10px; border-radius: 4px;">WH</span>
            <span style="color: black; margin-left: 5px;">- Weekoff</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #A9CDD4; color: white; padding: 5px 10px; border-radius: 4px;">NH</span>
            <span style="color: black; margin-left: 5px;">- Holiday</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #BF9FBA; color: white; padding: 5px 10px; border-radius: 4px;">OD</span>
            <span style="color: black; margin-left: 5px;">- Onduty</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #705720d1;; color: white; padding: 5px 10px; border-radius: 4px;">XL</span>
            <span style="color: black; margin-left: 5px;">- Present with half-day Leave</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #705720d1;; color: white; padding: 5px 10px; border-radius: 4px;">LX</span>
            <span style="color: black; margin-left: 5px;">- Present with half-day Leave</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #CCEA8D; color: white; padding: 5px 10px; border-radius: 4px;">AL</span>
            <span style="color: black; margin-left: 5px;">- Absent with half-day Leave</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #CCEA8D; color: white; padding: 5px 10px; border-radius: 4px;">LA</span>
            <span style="color: black; margin-left: 5px;">- Absent with half-day Leave</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color:#F2CA52; color: white; padding: 5px 10px; border-radius: 4px;">XA</span>
            <span style="color: black; margin-left: 5px;">- Present with half-day Absent</span>
        </div>
    
        <div style="display: flex; align-items: center;">
            <span style="background-color: #F2CA52; color: white; padding: 5px 10px; border-radius: 4px;">AX</span>
            <span style="color: black; margin-left: 5px;">- Present with half-day Absent</span>
        </div>
    </div>
    <div>
        <button style="margin-top: 20px; margin-left: 150px;" title="Export Excel" type="button" (click)="exportExcel()"
            class="btn btn-icon btn-sm bg-success me-8 ms-2">
            <i class="bi bi-file-earmark-arrow-up fs-3"></i>
        </button>

        <!-- <button style="margin-top: 20px; margin-left: 0px;" title="Export Pdf" type="button" (click)="pdf()"
           style="background: radial-gradient(circle, #47acbe 0%, #4aa5b9 100%);" class="btn btn-icon btn-sm bg-danger me-8 me-2 mt-7">
            <i class="fa-solid fa-file-pdf"></i>
        </button> -->
    </div>
<div class="table-responsive shadow p-3 mb-5 bg-white rounded">

    <div class="mx-3 p-3 pt-0 pb-0 bg-white rounded">
        <table id="MonthlyDetailsReport" class="table table-striped table-row-bordered gy-5 gs-7 ">
            <thead>
                <tr *ngIf="searchClicked" class=" text-white fw-bold fs-7 text-nowrap bg-lightblue text-blue align-middle">
                    <th>S.No</th>
                    <th>Employee Code</th>
                    <th>Name</th>
                    <ng-container *ngFor="let day of displayedDays">
                        <th>{{ day }}</th>
                    </ng-container>
                    <th class="d-lg-none">Total Present</th>
                    <th class="d-lg-none">Total Absent</th>
                    <th class="d-lg-none">Total Week Off</th>
                    <th class="d-lg-none">Total National Holiday</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of GetMonthwiseOrderReport_List; let i=index;" class="align-middle">
                    <td>{{i+1}}</td>
                    <td>{{data.user_code}}</td>
                    <td style="width: auto;">{{data.user_name}}</td>
                        <td *ngFor="let day of displayedDays" style="border: 1px solid rgba(27, 158, 210, 0.63);"
                        [style.background-color]="getColorBasedOnCondition(data['date' + day])">
                      {{ data['date' + day] }}
                    </td>
                   
                </tr>
            </tbody>
        </table>
    </div>

</div>
</div>