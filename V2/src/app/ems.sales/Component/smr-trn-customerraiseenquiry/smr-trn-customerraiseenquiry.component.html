<div class="card rounded-top">
    <div class="card-title p-5 pb-6 pt-6 rounded-top bg-primary">
        <h3 class="fw-bolder text-white"><i class="fa-solid fa-plus text-white  fs-4"></i> &nbsp;&nbsp; Raise
            Enquiry
        </h3>
    </div>
    <!-- <div>
            <i class="bi bi-arrow-left-square-fill fs-1  text-black" (click)="onclose()"></i>
        </div> -->

    <form [formGroup]="combinedFormData" >
        <div class="m-4 mt-4 border card">
            <div class="d-flex flex-row m-6 flex-wrap">
                <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"> <span class="font-bold">Enquiry Ref. No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input"        
                placeholder="New Reference No"
                            formControlName="enquiry_gid" class="form-control" readonly style="height:40px;" />
                    </div>
                </div> -->
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Customer Enquiry Ref. No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0  borderc-secondary bg-white custom-input" readonly
                            formControlName="enquiry_referencenumber" style="height:30px;" class="form-control"
                            placeholder="Enter Enquiry Ref. No" />
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Enquiry Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="date" class="date-picker
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input picker
                " placeholder="DD-MM-YYYY" formControlName="enquiry_date" style="height:40px;"
                            [ngClass]="{'invalid-border': enquiry_date.invalid && enquiry_date.touched}" />
                        <div *ngIf=" enquiry_date.invalid &&
                (enquiry_date.dirty || enquiry_date.touched)
         " class="text-red">
                            <div *ngIf="enquiry_date.errors?.['required']">
                                Enquiry Date is required.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Branch</span>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="branch_name" [items]="branch_list"
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2 no-arrow" bindLabel="branch_name"
                            bindValue="branch_gid" placeholder="Select an option" [(ngModel)]="mdlBranch"></ng-select>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 mt-0 flex-wrap">
                <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Customer Enquiry Ref. No</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="enquiry_referencenumber"
                            style="height:40px;" class="form-control" />
                    </div>
                </div> -->
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"> <span class="font-bold required">Lead</span>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="leadbank_name" [items]="Lead_list" required
                            (clear)="OnClearCustomerName()"
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2 no-arrow" bindLabel="leadbank_name" 
                            placeholder="Select an option" [(ngModel)]="mdlcus" (change)="GetOnChangeLeadName()"
                            [ngClass]="{'invalid-border': leadbank_name.invalid && leadbank_name.touched}"></ng-select>
                        <div *ngIf=" leadbank_name.invalid &&
                (leadbank_name.dirty || leadbank_name.touched)
         " class="text-red">
                            <div *ngIf="leadbank_name.errors?.['required']">
                                Select Lead
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 "><span class="font-bold">Lead Branch</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2 ">
                        <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input 
                    mb-3 mb-lg-0  borderc-secondary bg-secondary custom-input" readonly [(ngModel)]="txtCustomerBranch"
                            formControlName="leadbankbranch_name" style="height:40px;" />
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12 font-bold">Contact Person
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="form-control bg-secondary" formControlName="leadbankcontact_name"
                            readonly [(ngModel)]="txtContactPerson" style="height:30px;">
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 mt-0 flex-wrap">
                <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12 font-bold">Contact Person
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="form-control bg-secondary" formControlName="customercontact_name"
                            readonly [(ngModel)]="txtContactPerson" style="height:40px;">
                    </div>
                </div> -->
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Contact Number</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0  borderc-secondary custom-input  bg-secondary" formControlName="contact_number"
                            readonly [(ngModel)]="txtContactNumber" style="height:40px;" />
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Email ID</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="text" class="form-control bg-secondary" formControlName="contact_email" readonly
                            [(ngModel)]="txtEmailid" style="height:30px;">
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"> <span class="font-bold ">Address</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                    form-control form-control-lg form-control-solid custom-input
                    mb-3 mb-lg-0  borderc-secondary custom-input" formControlName="contact_address"
                            [(ngModel)]="txtAddress" class="form-control  bg-secondary " rows="3"></textarea>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-row m-6 mt-0 flex-wrap">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Enquiry Assigned To
                    </span>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="user_firstname" [items]="assign_list" required
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2 no-arrow" bindLabel="user_firstname"
                            bindValue="employee_gid" placeholder="Select an option"
                            [(ngModel)]="mdlEmployee"></ng-select>
                    </div>
                </div>


                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Enquiry Rating</span>
                    <div class="col-lg-12 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <ng-select formControlName="customer_rating"
                            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2 no-arrow"
                            placeholder="Select an option" [(ngModel)]="mdlEnq">
                            <ng-option value="Cold">Cold</ng-option>
                            <ng-option value="Warm">Warm</ng-option>
                            <ng-option value="Hot">Hot</ng-option>
                        </ng-select>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Expected Closure Date</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <input type="date" pattern="^(?!\s*$).+" [ngStyle]="{ 'height': '42px'}"
                            formControlName="closure_date" class="picker"
                            class="form-control form-control-lg  form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white borderc-secondary custom-input date-picker mt-2"
                            placeholder="DD-MM-YYYY" />
                    </div>
                </div>


            </div>
            <div class="d-flex flex-row m-6 mt-0 flex-wrap">
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Enquiry Remarks</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="enquiry_remarks"
                            placeholder="Enter Enquiry Remarks" class="form-control" rows="5"></textarea>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Customer Requirment</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="customer_requirement"
                            placeholder="Enter Customer Requirment" class="form-control" rows="5"></textarea>
                    </div>
                </div>
                <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Landmark</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="landmark"
                            placeholder="Enter Customer Landmark" class="form-control" rows="5"></textarea>
                    </div>
                </div>

            </div>

            <div class="d-flex flex-row m-6 mt-0 flex-wrap">
                <!-- <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold ">Enquiry Remarks</span>
                    <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                        <textarea type="text" class="
                form-control form-control-lg form-control-solid custom-input
                mb-3 mb-lg-0  borderc-secondary bg-white custom-input" formControlName="enquiry_remarks"
                            placeholder="Enter Enquiry Remarks" class="form-control" rows="3"></textarea>
                    </div>
                </div> -->

            </div>

            <!--product summary-->
            <div class="tab-content ">
                <form [formGroup]="productform">
                    <input type="hidden" formControlName="tmpsalesenquiry_gid">
                <table id="POproductlist" class="table table-striped table-row-bordered gy-5 gs-7 ">
                    <thead>
                        <tr class="fw-bold fs-5 text-nowrap bg-lightblue text-blue">
                            <!-- <th>Customer Product Code</th> -->
                            <th >Product Group</th>
                            <th>Product Code</th>
                            <th style="width: 35%;">Product</th>
                            <th style="width: 10%;">Unit</th>
                            <th>Quantity</th>
                            <th>Potential value</th>
                            <th>Need By Date</th>
                            <th class="align-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr>
                            <td class="pt-1 pb-1 padding_custom">
                                <input type="text" class="form-control form-control-lg form-control-solid custom-input custom_height borderc-secondary bg-white custom-input" 
                                formControlName="productgroup_name" readonly
                                [(ngModel)]="txtProductGroup" style="height:40px;">

                            </td>
                            <td class="padding_custom">
                                <ng-select formControlName="product_code" class="fixed-width custom-ng-select"
                                    [items]="SOProductList" required bindLabel="product_code" bindValue="product_code"
                                    placeholder="Select Product Code" (clear)="onclearproductcode()"
                                    [(ngModel)]="productcodesearch1" (change)="OnProductCode($event)" appendTo="body"
                                    class="no-arrow">
                                </ng-select>

                            </td>
                            <td class=" padding_custom" style="width: 18% !important;">
                                <ng-select formControlName="product_name" [items]="SOProductList" required
                                    (clear)="onclearproduct()" bindValue="product_gid"
                                    class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row no-arrow"
                                    bindLabel="product_name" placeholder="Select an option"
                                    (change)="onProductSelect($event)" [(ngModel)]="productcodesearch"
                                    style="height:40px;"></ng-select>

                            </td>
                            <td class=" padding_custom">
                                <input type="text" class="form-control form-control-lg form-control-solid custom-input custom_height borderc-secondary bg-white custom-input"
                                 formControlName="productuom_name" readonly
                                [(ngModel)]="txtUnit" style="height:40px;">
                            </td>

                            <td class=" padding_custom" >
                                <input type="number" required
                                    class="form-control form-control-lg form-control-solid custom-input custom_height borderc-secondary bg-white custom-input"
                                    placeholder="0.00" formControlName="qty_requested"
                                    class="form-control"  style="height:30px;text-align: right;"/>
                            </td>
                            <td class=" padding_custom" style="width: 2%;">
                                <input type="number" class="form-control form-control-lg form-control-solid custom-input custom_height borderc-secondary bg-white custom-input"
                                    formControlName="potential_value" class="form-control"
                                     placeholder="0.00" style="height:30px; text-align: right;"/>
                            </td>
                            
                            <!-- <td class=" padding_custom" colspan="2">
                           </td> -->
                            <td class=" padding_custom" >
                                <input type="date" pattern="^(?!\s*$).+" formControlName="product_requireddate" class="form-control borderc-secondary form-control-lg form-control-solid date-picker custom-input mb-3 mb-lg-0 bg-white 
                                custom-input date-picker " placeholder="DD-MM-YYYY" />
                            </td>
                            <td class="padding_custom text-center">
                                <button title="Add" type="button" class="btn btn-icon btn-sm bg-success me-1"
                                (click)="productSubmit()" *ngIf="showAddButton">
                                <span Class="fa-solid fa-plus text-white  fs-6"></span></button>&nbsp;
                            <button title="Update" type="button" (click)="onupdate()" *ngIf="showUpdateButton"
                                class="btn btn-icon btn-sm bg-primary me-1"><span
                                    class="fa-solid fa-arrow-up text-white  fs-6"></span></button>
                            </td>
                        </tr>

                        <tr *ngFor="let data of POproductlist; ">
                            <!-- <td>{{data.customerproduct_code}}</td> -->
                            <td>{{data.productgroup_name}}</td>
                            <td>{{data.product_code}}</td>
                            <td>{{data.product_name}}</td>
                            <td>{{data.productuom_name}}</td>
                            <td>{{data.qty_requested}}</td>
                            <td class="text-end">{{data.potential_value}}</td>
                            <td class="text-center">{{data.product_requireddate}}</td>
                            <td>
                                <button title="Delete" type="button" (click)="openModaldelete(data.tmpsalesenquiry_gid)"
                                    data-bs-toggle="modal" data-bs-target="#myModaldeletes"
                                    class="btn btn-icon btn-sm bg-danger me-1"><span
                                        class="fa-solid fa-trash text-white  fs-6"></span></button>&nbsp;

                            </td>
                        </tr>
                    </tbody>
                </table>
           
            </form>
        </div>

            <div class="text-center my-4">
                <button type="submit" class="btn-success text-white me-4" [disabled]="combinedFormData.invalid"
                    [ngClass]="{'primary-button': !combinedFormData.invalid,'secondary-button': combinedFormData.invalid}"
                    data-bs-dismiss="modal" (click)="onSubmit()">
                    <i class="fas fa-check text-white fs-5 "></i> &nbsp;Submit
                </button>
                <button class="btn-primary btn-sm text-white me-4" (click)="onclose()">
                    <i class="fas fa-arrow-left fs-5">
                        <i class="path1"></i>
                        <i class="path2"></i>
                    </i>&nbsp;Back</button>
            </div>


        </div>
    </form>
    <div class="modal" id="myModaldeletes" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="text-center my-4">
                    <h2><b>Are you sure?</b></h2>
                    <br>
                    <p style="display: block;">Do You Want To Delete the Record ?</p>
                    <div class="text-center my-4">
                        <button class="btn-danger btn-sm text-white me-4" (click)="ondelete()" data-bs-dismiss="modal">
                            <i class="fas fa-trash text-white fs-5 "></i> &nbsp;Delete
                        </button>
                        <button class="btn-primary btn-sm text-white me-2" data-bs-dismiss="modal">
                            <i class="fas fa-close text-white"></i> &nbsp;Close
                        </button>&nbsp;

                    </div>
                </div>
            </div>
        </div>
    </div>